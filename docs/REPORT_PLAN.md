# План реализации: Ведомость учебной группы (PDF)

## 1. Анализ требований

Необходимо реализовать функцию скачивания ведомости успеваемости по конкретной дисциплине для учебной группы.
**Ключевые особенности:**

- Формат: PDF.
- Стилистика: Красивый, формальный дизайн, шрифты Poppins/Montserrat.
- Содержание: Информация о курсе/группе, Таблица (ФИО, Даты, Оценки), Подпись инструктора.
- Технические нюансы: Поддержка кириллицы (требует кастомных шрифтов), ориентация страницы (Landscape для широких таблиц).

## 2. Предлагаемое решение

### Технический стек

- **Библиотека**: `jspdf` (уже есть в проекте) + `jspdf-autotable` (необходимо добавить).
- **Причина выбора**: Это стандарт де-факто для генерации PDF на клиенте. Позволяет точно управлять версткой, разрывами страниц и стилизацией таблиц, в отличие от простых скриншотов (`html2canvas`).

### Дизайн и Структура документа

Мы будем использовать **альбомную ориентацию (Landscape)**, чтобы вместить больше дат занятий.

#### Шапка (Header)

- Логотип платформы (опционально, если есть вектор/изображение).
- Название документа: **"ЗАЧЕТНАЯ ВЕДОМОСТЬ / GRADE SHEET"** (крупно, жирно).
- Блок информации (Grid):
  - **Дисциплина**: [Название дисциплины]
  - **Группа**: [Код группы]
  - **Даты проведения**: [Дата первого занятия] — [Дата последнего занятия]
  - **Инструктор**: [ФИО Инструктора]

#### Таблица (Body)

- **Столбцы**:
  1. **№** (узкий)
  2. **ФИО слушателя** (широкий, выравнивание по левому краю).
  3. **Даты занятий** (серия узких столбцов). Заголовки вертикальные или короткие (DD.MM).
  4. **Итого** (Посещаемость % / Средний балл).
  5. **Итоговая оценка** (Жирный шрифт).
- **Стилизация**:
  - Чересстрочная заливка (улучшает читаемость).
  - Жирные заголовки (как в требовании).
  - Шрифт: Poppins (с поддержкой кириллицы).

#### Подвал (Footer)

- Линия для подписи.
- Текст: "Инструктор: ********\_******** / [ФИО]"
- Дата формирования документа.

## 3. План реализации

### Шаг 1: Подготовка

1. Установить `jspdf-autotable`: `npm install jspdf-autotable`.
2. Подготовить шрифт **Poppins** (Regular и Bold) с поддержкой кириллицы в формате Base64 (или файл в `public/`), чтобы `jspdf` мог его использовать. _Без этого русские буквы не отобразятся._

### Шаг 2: Создание утилиты генерации

Создать файл `utils/pdf/generateGroupReport.ts`:

- Функция принимает данные журнала (в том виде, в каком они приходят с API).
- Конвертирует даты.
- Формирует структуру для `autotable`.
- Генерирует PDF файл.

### Шаг 3: Интеграция в UI

- В файле `app/pages/groups/journal/[slug].vue`:
  - Добавить кнопку "Скачать ведомость" (иконка Download) в заголовок рядом со статистикой.
  - Подключить утилиту генерации.
  - Добавить состояние загрузки (пока генерируется PDF).

## 4. Предложения и улучшения

1. **Ориентация страницы**: Настоятельно рекомендую использовать **Landscape (Альбомную)** ориентацию автоматически, если количество занятий превышает 10-12, иначе колонки будут слишком узкими.
2. **Фильтрация**: Если занятий очень много (например, 30+), таблица может быть разбита на несколько страниц автоматически (jspdf-autotable умеет это делать, но заголовки будут повторяться).
3. **Статус сдачи**: Можно добавить колонку "Статус" (Сдал / Не сдал) на основе итоговой оценки.
4. **Заголовки дат**: Для экономии места даты в заголовках можно повернуть на 90 градусов (если библиотека позволит чисто сделать, иначе просто "DD.MM").

---

**Готов приступить к реализации по этому плану. Начинаем с установки зависимостей?**
