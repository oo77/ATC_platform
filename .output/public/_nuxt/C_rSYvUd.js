import{_ as Q}from"./BKg9m4wI.js";import{_ as G}from"./BMofnORk.js";import{_ as J}from"./BJSmDEn_.js";import{_ as K}from"./BNigTcCY.js";import{v as W,Q as X,s as Y,r as a,q as Z,g as tt,c,a as t,h as x,k as v,b as i,w as y,i as N,t as o,F as B,x as C,j as et,y as D,n as H,d as m,B as rt,o as l}from"./GLV6bXvn.js";import{I as st,a as ot}from"./D81SDHNc.js";import{u as at}from"./DlZaGH1J.js";import{u as lt}from"./DVL-QcDc.js";import{u as it}from"./DW2J_Y_n.js";import{C as dt,U as nt}from"./DbDyPcRw.js";import{A as ut}from"./Lqo7GKtw.js";import{C as ct}from"./BLDR1O4k.js";import{c as mt}from"./CVqvr-Q5.js";import"./CyDLpZDf.js";import"./CFbq0LVm.js";import"./CRUGdXr-.js";const gt=mt("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),pt={class:"mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10"},xt={class:"mb-6"},vt={key:0,class:"flex justify-center items-center py-20"},yt={key:1,class:"rounded-lg border border-danger/30 bg-danger/5 p-8 text-center"},bt={class:"mt-2 text-gray-600 dark:text-gray-400"},ft={class:"bg-white dark:bg-boxdark rounded-2xl shadow-lg overflow-hidden mb-6"},ht={class:"relative px-8 pb-8"},kt={class:"flex flex-col sm:flex-row items-end gap-6 -mt-16 mb-6"},_t={class:"relative"},wt={class:"h-32 w-32 rounded-2xl bg-white dark:bg-boxdark shadow-xl flex items-center justify-center border-4 border-white dark:border-boxdark"},Ct={class:"text-5xl font-bold text-primary"},Dt={class:"flex-1 pb-2 text-center sm:text-left"},Mt={class:"text-3xl font-bold text-black dark:text-white mb-2"},It={class:"text-lg text-gray-600 dark:text-gray-400"},jt={class:"flex gap-3 pb-2 w-full sm:w-auto justify-center sm:justify-end"},Et={class:"flex flex-col gap-6"},Lt={class:"rounded-lg bg-gray-50 p-1 dark:bg-gray-800"},Nt={class:"flex gap-1","aria-label":"Tabs"},Bt=["onClick"],Ht={class:"flex items-center justify-center gap-2"},Ut={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},At={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark p-6"},Rt={class:"space-y-3"},St={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Ft={class:"font-medium text-gray-900 dark:text-white"},Tt={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Vt={class:"font-medium text-gray-900 dark:text-white"},$t={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},qt={class:"font-medium text-gray-900 dark:text-white"},zt={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Ot={class:"font-medium text-gray-900 dark:text-white font-mono text-sm"},Pt={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark p-6"},Qt={class:"space-y-3"},Gt={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Jt={class:"font-medium text-gray-900 dark:text-white"},Kt={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Wt={class:"font-medium text-gray-900 dark:text-white"},Xt={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Yt={class:"font-medium text-gray-900 dark:text-white"},Zt={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},be=W({__name:"[id]",setup(te){const U=X(),A=Y(),b=U.params.id,{authFetch:f}=at(),g=lt();it();const r=a(null),h=a(!1),n=a(null),p=a(!1),k=a(!1),_=a(!1),d=a("info"),R=[{id:"info",label:"Информация",icon:nt},{id:"hours",label:"Отчётность",icon:ct},{id:"history",label:"История курсов",icon:gt}],S=s=>s.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),F=s=>new Date(s).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}),M=async()=>{h.value=!0,n.value=null;try{const s=await f(`/api/instructors/${b}`);s.success?r.value=s.instructor:n.value="Не удалось загрузить данные инструктора"}catch(s){n.value=s.message||"Ошибка загрузки"}finally{h.value=!1}},T=()=>{p.value=!0},I=()=>{p.value=!1},V=async s=>{try{const e=await f(`/api/instructors/${b}`,{method:"PUT",body:s});e.success&&(r.value=e.instructor,I(),g.success("Данные инструктора обновлены"))}catch(e){console.error("Error updating instructor:",e),g.error("Ошибка при обновлении инструктора")}},$=()=>{k.value=!0},j=()=>{k.value=!1},q=async()=>{_.value=!0;try{await f(`/api/instructors/${b}`,{method:"DELETE"}),g.success("Инструктор удален"),A.push("/users")}catch(s){console.error("Error deleting instructor:",s),g.error("Ошибка при удалении инструктора")}finally{_.value=!1,j()}},E=a(null),L=a(null);return Z(d,s=>{s==="hours"?E.value?.load():s==="history"&&L.value?.load()}),tt(()=>{M()}),(s,e)=>{const z=Q,w=G,O=J,P=K;return l(),c("div",pt,[t("div",xt,[i(z,{to:"/users",class:"inline-flex items-center gap-2 text-primary hover:underline"},{default:y(()=>[i(N(ut),{class:"h-4 w-4"}),e[0]||(e[0]=m(" Назад к списку пользователей ",-1))]),_:1})]),h.value?(l(),c("div",vt,[...e[1]||(e[1]=[t("div",{class:"flex flex-col items-center gap-4"},[t("div",{class:"h-12 w-12 animate-spin rounded-full border-4 border-solid border-primary border-t-transparent"}),t("p",{class:"text-gray-600 dark:text-gray-400"}," Загрузка данных инструктора... ")],-1)])])):n.value?(l(),c("div",yt,[i(N(dt),{class:"mx-auto h-12 w-12 text-danger"}),e[3]||(e[3]=t("h3",{class:"mt-4 text-lg font-semibold text-gray-900 dark:text-white"}," Ошибка загрузки ",-1)),t("p",bt,o(n.value),1),i(w,{variant:"primary",class:"mt-4",onClick:M},{default:y(()=>[...e[2]||(e[2]=[m(" Попробовать снова ",-1)])]),_:1})])):r.value?(l(),c(B,{key:2},[t("div",ft,[e[7]||(e[7]=t("div",{class:"h-32 bg-linear-to-r from-primary via-purple-500 to-pink-500 relative"},[t("div",{class:"absolute inset-0 bg-black/10"})],-1)),t("div",ht,[t("div",kt,[t("div",_t,[t("div",wt,[t("span",Ct,o(S(r.value.fullName)),1)]),e[4]||(e[4]=t("div",{class:"absolute -bottom-2 -right-2 h-10 w-10 bg-success rounded-full border-4 border-white dark:border-boxdark flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})])],-1))]),t("div",Dt,[t("h1",Mt,o(r.value.fullName),1),t("p",It,o(r.value.email||"Email не указан"),1)]),t("div",jt,[i(w,{variant:"primary",onClick:T,class:"flex items-center gap-2"},{default:y(()=>[...e[5]||(e[5]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586"})],-1),m(" Редактировать ",-1)])]),_:1}),i(w,{variant:"danger",onClick:$,class:"flex items-center gap-2"},{default:y(()=>[...e[6]||(e[6]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1v3M4 7h16"})],-1),m(" Удалить ",-1)])]),_:1})])])])]),t("div",Et,[t("div",Lt,[t("nav",Nt,[(l(),c(B,null,et(R,u=>t("button",{key:u.id,onClick:ee=>d.value=u.id,class:H(["flex-1 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200",d.value===u.id?"bg-primary text-white shadow-sm":"text-gray-600 hover:bg-white hover:text-gray-900 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"])},[t("span",Ht,[(l(),v(rt(u.icon),{class:"h-5 w-5"})),m(" "+o(u.label),1)])],10,Bt)),64))])]),C(t("div",null,[t("div",Ut,[t("div",At,[e[12]||(e[12]=t("h3",{class:"mb-4 text-xl font-semibold text-gray-900 dark:text-white"}," Личная информация ",-1)),t("div",Rt,[t("div",St,[e[8]||(e[8]=t("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Полное имя ",-1)),t("p",Ft,o(r.value.fullName),1)]),t("div",Tt,[e[9]||(e[9]=t("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Email ",-1)),t("p",Vt,o(r.value.email||"—"),1)]),t("div",$t,[e[10]||(e[10]=t("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Телефон ",-1)),t("p",qt,o(r.value.phone||"—"),1)]),t("div",zt,[e[11]||(e[11]=t("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," ID ",-1)),t("p",Ot,o(r.value.id),1)])])]),t("div",Pt,[e[17]||(e[17]=t("h3",{class:"mb-4 text-xl font-semibold text-gray-900 dark:text-white"}," Рабочая информация ",-1)),t("div",Qt,[t("div",Gt,[e[13]||(e[13]=t("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Дата приема на работу ",-1)),t("p",Jt,o(r.value.hireDate?F(r.value.hireDate):"—"),1)]),t("div",Kt,[e[14]||(e[14]=t("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Максимальное количество часов ",-1)),t("p",Wt,o(r.value.maxHours)+" часов ",1)]),t("div",Xt,[e[15]||(e[15]=t("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Информация о контракте ",-1)),t("p",Yt,o(r.value.contractInfo||"—"),1)]),t("div",Zt,[e[16]||(e[16]=t("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Статус ",-1)),t("span",{class:H(["inline-flex rounded-full px-3 py-1 text-sm font-medium",r.value.isActive?"bg-success/10 text-success":"bg-danger/10 text-danger"])},o(r.value.isActive?"Активен":"Неактивен"),3)])])])])],512),[[D,d.value==="info"]]),C(t("div",null,[r.value?(l(),v(st,{key:0,"instructor-id":r.value.id,"initial-load":!1,ref_key:"hoursStatsRef",ref:E},null,8,["instructor-id"])):x("",!0)],512),[[D,d.value==="hours"]]),C(t("div",null,[r.value?(l(),v(ot,{key:0,"instructor-id":r.value.id,"initial-load":!1,ref_key:"courseHistoryRef",ref:L},null,8,["instructor-id"])):x("",!0)],512),[[D,d.value==="history"]])])],64)):x("",!0),p.value&&r.value?(l(),v(O,{key:3,instructor:r.value,"is-open":p.value,onClose:I,onSubmit:V},null,8,["instructor","is-open"])):x("",!0),i(P,{"is-open":k.value,title:"Удаление инструктора",message:"Вы уверены, что хотите удалить этого инструктора? Это действие может повлиять на связанные курсы и расписание.","item-name":r.value?.fullName,warning:"Это действие нельзя отменить.",loading:_.value,onConfirm:q,onCancel:j},null,8,["is-open","item-name","loading"])])}}});export{be as default};
