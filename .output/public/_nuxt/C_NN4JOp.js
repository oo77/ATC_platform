import{_ as $}from"./BMofnORk.js";import{_ as O}from"./BKg9m4wI.js";import{_ as Q,a as q}from"./pWOVuSBC.js";import{v as J,Q as K,e as W,r as d,f as n,u as X,g as Y,c as i,h as m,a as e,b,i as M,t as a,w as y,F as A,k as v,n as U,j as Z,x as ee,y as te,d as p,B as re,o}from"./GLV6bXvn.js";import{u as se}from"./DlZaGH1J.js";import"./DVL-QcDc.js";import{C as ae,U as oe}from"./DbDyPcRw.js";import{A as le}from"./Lqo7GKtw.js";import"./CFbq0LVm.js";import"./CRUGdXr-.js";import"./CVqvr-Q5.js";const de={class:"mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10"},ne={key:0,class:"flex items-center justify-center py-20"},ie={key:1,class:"rounded-lg border border-danger/30 bg-danger/5 p-8 text-center"},ue={class:"mt-2 text-gray-600 dark:text-gray-400"},ge={class:"mb-6"},ce={class:"bg-white dark:bg-boxdark rounded-2xl shadow-lg overflow-hidden mb-6"},me={class:"relative px-8 pb-8"},ve={class:"flex items-end gap-6 -mt-16 mb-6"},pe={class:"relative"},xe={class:"h-32 w-32 rounded-2xl bg-white dark:bg-boxdark shadow-xl flex items-center justify-center border-4 border-white dark:border-boxdark"},be={class:"text-5xl font-bold text-primary"},ye={class:"flex-1 pb-2"},fe={class:"text-3xl font-bold text-black dark:text-white mb-2"},ke={class:"text-lg text-gray-600 dark:text-gray-400"},_e={class:"flex gap-3 pb-2"},he={class:"flex flex-col gap-6"},we={class:"rounded-lg bg-gray-50 p-1 dark:bg-gray-800"},Ce={class:"flex gap-1","aria-label":"Tabs"},Me=["onClick"],Ae={class:"flex items-center justify-center gap-2"},Ue={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},De={class:"p-6"},Ee={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Ne={class:"space-y-3"},Re={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Be={class:"font-medium text-gray-900 dark:text-white"},Ie={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Le={class:"font-medium text-gray-900 dark:text-white"},Se={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},je={class:"font-medium text-gray-900 dark:text-white"},He={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Te={class:"font-medium text-gray-900 dark:text-white"},Pe={class:"space-y-3"},ze={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Fe={class:"font-medium text-gray-900 dark:text-white"},Ge={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Ve={class:"font-medium text-gray-900 dark:text-white"},$e={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Oe={class:"font-medium text-gray-900 dark:text-white"},Qe={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},qe={class:"font-medium text-gray-900 dark:text-white"},dt=J({__name:"[id]",setup(Je){const D=K(),{user:l}=W(),{authFetch:E}=se(),f=d(!0),u=d(null),r=d(null),k=d("info"),_=d(!1),x=d(!1),N=n(()=>D.params.id);n(()=>r.value?.name?`https://ui-avatars.com/api/?name=${encodeURIComponent(r.value.name)}&size=128&background=465fff&color=fff&bold=true`:"");const R=n(()=>[{id:"info",label:"Информация",icon:oe}]),B=n(()=>!l.value||!r.value?!1:l.value.role==="ADMIN"||l.value.role==="MANAGER"&&r.value.role!=="ADMIN"?!0:l.value.id===r.value.id),I=n(()=>!l.value||!r.value?!1:l.value.role==="ADMIN"||l.value.role==="MANAGER"&&r.value.role!=="ADMIN"),L=s=>({ADMIN:"Администратор",MANAGER:"Модератор",TEACHER:"Инструктор",STUDENT:"Студент"})[s||""]||s||"",S=s=>new Date(s).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}),h=async()=>{f.value=!0,u.value=null;try{const s=await E(`/api/users/${N.value}`);s.success&&s.user?r.value=s.user:u.value=s.message||"Не удалось загрузить данные пользователя"}catch(s){console.error("Error loading user:",s),u.value=s?.data?.message||s?.message||"Ошибка загрузки пользователя"}finally{f.value=!1}},j=()=>{_.value=!0},w=()=>{_.value=!1},H=async()=>{await h(),w()},T=()=>{x.value=!0},C=()=>{x.value=!1},P=()=>{C()},z=s=>{const t=s.split(" ").filter(g=>g.length>0);return t.length>=2&&t[0]&&t[1]&&t[0].length>0&&t[1].length>0?(t[0][0]+t[1][0]).toUpperCase():s.length>=2?s.substring(0,2).toUpperCase():s.toUpperCase()};return X({title:n(()=>r.value?.name?`${r.value.name} | Профиль пользователя`:"Профиль пользователя")}),Y(()=>{h()}),(s,t)=>{const g=$,F=O,G=Q,V=q;return o(),i("div",de,[f.value?(o(),i("div",ne,[...t[0]||(t[0]=[e("div",{class:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"},null,-1)])])):u.value?(o(),i("div",ie,[b(M(ae),{class:"mx-auto h-12 w-12 text-danger"}),t[2]||(t[2]=e("h3",{class:"mt-4 text-lg font-semibold text-gray-900 dark:text-white"}," Ошибка загрузки ",-1)),e("p",ue,a(u.value),1),b(g,{variant:"primary",class:"mt-4",onClick:h},{default:y(()=>[...t[1]||(t[1]=[p(" Попробовать снова ",-1)])]),_:1})])):r.value?(o(),i(A,{key:2},[e("div",ge,[b(F,{to:"/users",class:"inline-flex items-center gap-2 text-primary hover:underline"},{default:y(()=>[b(M(le),{class:"h-4 w-4"}),t[3]||(t[3]=p(" Назад к списку пользователей ",-1))]),_:1})]),e("div",ce,[t[7]||(t[7]=e("div",{class:"h-32 bg-linear-to-r from-primary via-purple-500 to-pink-500 relative"},[e("div",{class:"absolute inset-0 bg-black/10"})],-1)),e("div",me,[e("div",ve,[e("div",pe,[e("div",xe,[e("span",be,a(z(r.value.name)),1)]),e("div",{class:U(["absolute -bottom-2 -right-2 h-10 w-10 rounded-full border-4 border-white dark:border-boxdark flex items-center justify-center",[r.value.role==="ADMIN"?"bg-danger":r.value.role==="MANAGER"?"bg-warning":"bg-success"]])},[...t[4]||(t[4]=[e("svg",{class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)])],2)]),e("div",ye,[e("h1",fe,a(r.value.name),1),e("p",ke,a(r.value.email),1)]),e("div",_e,[B.value?(o(),v(g,{key:0,variant:"primary",class:"flex items-center gap-2",onClick:j},{default:y(()=>[...t[5]||(t[5]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),p(" Редактировать ",-1)])]),_:1})):m("",!0),I.value?(o(),v(g,{key:1,variant:"warning",class:"flex items-center gap-2",onClick:T},{default:y(()=>[...t[6]||(t[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})],-1),p(" Сбросить пароль ",-1)])]),_:1})):m("",!0)])])])]),e("div",he,[e("div",we,[e("nav",Ce,[(o(!0),i(A,null,Z(R.value,c=>(o(),i("button",{key:c.id,onClick:Ke=>k.value=c.id,class:U(["flex-1 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200",k.value===c.id?"bg-primary text-white shadow-sm":"text-gray-600 hover:bg-white hover:text-gray-900 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"])},[e("span",Ae,[(o(),v(re(c.icon),{class:"h-5 w-5"})),p(" "+a(c.label),1)])],10,Me))),128))])]),e("div",Ue,[ee(e("div",De,[e("div",Ee,[e("div",null,[t[12]||(t[12]=e("h3",{class:"mb-4 text-xl font-semibold text-gray-900 dark:text-white"}," Личная информация ",-1)),e("div",Ne,[e("div",Re,[t[8]||(t[8]=e("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Полное имя ",-1)),e("p",Be,a(r.value.name),1)]),e("div",Ie,[t[9]||(t[9]=e("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Email ",-1)),e("p",Le,a(r.value.email),1)]),e("div",Se,[t[10]||(t[10]=e("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Телефон ",-1)),e("p",je,a(r.value.phone||"—"),1)]),e("div",He,[t[11]||(t[11]=e("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," ПИНФЛ ",-1)),e("p",Te,a(r.value.pinfl||"—"),1)])])]),e("div",null,[t[17]||(t[17]=e("h3",{class:"mb-4 text-xl font-semibold text-gray-900 dark:text-white"}," Рабочая информация ",-1)),e("div",Pe,[e("div",ze,[t[13]||(t[13]=e("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Роль в системе ",-1)),e("p",Fe,a(L(r.value.role)),1)]),e("div",Ge,[t[14]||(t[14]=e("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Место работы ",-1)),e("p",Ve,a(r.value.workplace||"—"),1)]),e("div",$e,[t[15]||(t[15]=e("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Должность ",-1)),e("p",Oe,a(r.value.position||"—"),1)]),e("div",Qe,[t[16]||(t[16]=e("p",{class:"mb-1 text-sm text-gray-600 dark:text-gray-400"}," Обновлено ",-1)),e("p",qe,a(S(r.value.updated_at)),1)])])])])],512),[[te,k.value==="info"]])])]),_.value&&r.value?(o(),v(G,{key:0,user:r.value,role:r.value.role,onClose:w,onSave:H},null,8,["user","role"])):m("",!0),x.value&&r.value?(o(),v(V,{key:1,"is-open":x.value,"user-id":r.value.id,"user-name":r.value.name,onClose:C,onSuccess:P},null,8,["is-open","user-id","user-name"])):m("",!0)],64)):m("",!0)])}}});export{dt as default};
