import{_ as U}from"./BKg9m4wI.js";import{Q as I,r as x,f as P,g as Q,c as d,a as t,b as T,w as h,d as m,t as r,n as i,l as q,F as y,j as f,h as l,x as k,y as v,k as z,u as G,o}from"./GLV6bXvn.js";import{u as J}from"./DlZaGH1J.js";import{u as K}from"./DVL-QcDc.js";import"./CFbq0LVm.js";import"./CRUGdXr-.js";const O={class:"mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10"},W={class:"mb-6"},X={key:0,class:"flex justify-center py-20"},Y={key:1,class:"text-center py-10"},Z={key:2,class:"space-y-6"},tt={class:"rounded-lg border border-gray-200 dark:border-gray-700 bg-white p-6 shadow-md dark:bg-boxdark"},et={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},st={class:"text-title-md2 font-bold text-black dark:text-white mb-2"},at={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},rt={class:"flex flex-col items-end gap-2"},ot={class:"text-sm text-gray-500"},dt={class:"mt-6"},nt={class:"mb-2 flex items-center justify-between"},it={class:"text-sm font-medium text-primary"},lt={class:"relative h-2.5 w-full rounded-full bg-gray-200 dark:bg-gray-700"},ut={class:"mt-2 text-xs text-gray-500 flex justify-between"},ct={class:"flex flex-col gap-6"},xt={class:"rounded-lg bg-gray-50 p-1 dark:bg-gray-800 w-fit overflow-x-auto max-w-full"},mt={class:"flex gap-1"},gt=["onClick"],pt={class:"rounded-lg border border-gray-200 dark:border-gray-700 bg-white shadow-md dark:bg-boxdark"},bt={class:"p-6"},yt={class:"space-y-4"},ft={key:0,class:"text-gray-500"},_t={class:"flex-1"},ht={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-1"},kt={class:"text-base font-semibold text-black dark:text-white"},vt={key:0,class:"ml-2 text-xs font-normal px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-600"},wt={class:"text-sm text-gray-500 mt-1"},jt={class:"mt-3 flex items-center gap-3"},Dt={key:1,class:"text-xs px-2 py-1 rounded bg-gray-100 text-gray-500"},Ct={key:2,class:"text-xs px-2 py-1 rounded font-bold bg-blue-50 text-blue-600 border border-blue-100 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800"},Lt={class:"p-6"},Bt={class:"flex justify-between items-center mb-4"},St={key:0,class:"flex justify-center py-10"},Vt={key:1,class:"flex flex-col items-center justify-center py-10 text-gray-500"},Tt={key:2,class:"grid gap-4 md:grid-cols-2 xl:grid-cols-2"},zt={class:"flex justify-between items-start mb-3"},Mt={class:"text-lg font-semibold text-black dark:text-white"},$t={class:"text-xs text-gray-500"},Nt={class:"space-y-2 text-sm text-gray-600 dark:text-gray-400 mb-4"},Rt={key:0,class:"flex items-center gap-2"},Ft={class:"flex items-center gap-2"},Et={key:1,class:"flex items-center gap-2"},Ht={key:2,class:"flex w-full justify-center rounded bg-gray-200 p-2 font-medium text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-400",disabled:""},At={class:"p-6"},Ut={key:0,class:"text-gray-500"},It={class:"grid gap-4 md:grid-cols-2"},Pt={class:"flex items-center gap-4"},Qt={class:"font-medium text-black dark:text-white"},qt={class:"text-sm text-gray-500"},Gt=["href"],Jt={class:"p-0"},Kt={class:"max-w-full overflow-x-auto"},Ot={class:"w-full table-auto"},Wt={key:0},Xt={class:"border-b border-[#eee] py-5 px-4 pl-9 dark:border-strokedark xl:pl-11"},Yt={class:"font-medium text-black dark:text-white"},Zt={class:"text-xs text-gray-500"},te={class:"border-b border-[#eee] py-5 px-4 dark:border-strokedark"},ee={class:"text-sm text-black dark:text-white"},se={class:"border-b border-[#eee] py-5 px-4 dark:border-strokedark"},ae={class:"border-b border-[#eee] py-5 px-4 dark:border-strokedark"},re={key:0,class:"font-bold text-black dark:text-white"},oe={key:1,class:"text-gray-400"},ge={__name:"[id]",setup(de){const w=I().params.id,j=x(!0),n=x(null),u=x("schedule"),g=x([]),p=x([]),D=x(!1),M=[{id:"schedule",label:"Программа обучения"},{id:"tests",label:"Тесты"},{id:"documents",label:"Документы"},{id:"grades",label:"Журнал оценок"}],L=P(()=>!n.value||!n.value.schedule?[]:n.value.schedule.filter(a=>b(a.start_time)||a.grade!==null)),{authFetch:C}=J(),$=async()=>{j.value=!0;try{const a=await C(`/api/students/my-courses/${w}`);a&&(n.value=a,G({title:`${a.info.course_name} | Занятия`}),N())}catch(a){console.error("Failed to fetch course details:",a),K().error("Курс не найден")}finally{j.value=!1}},N=async()=>{D.value=!0;try{const a=await C("/api/tests/my");a&&a.assignments&&(g.value=a.assignments.filter(c=>String(c.group_id)===String(w)));const s=await C("/api/certificates/my");s&&s.certificates&&(p.value=s.certificates.filter(c=>String(c.group_id)===String(w)))}catch(a){console.error("Error fetching related data",a)}finally{D.value=!1}},_=a=>a?new Date(a).toLocaleDateString("ru-RU"):"",B=a=>a?new Date(a).toLocaleString("ru-RU",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}):"",R=a=>({active:"Активен",completed:"Завершен",dropped:"Отчислен"})[a]||a,S=a=>({theory:"Лекция",practice:"Практика",assessment:"Тест/Экзамен",other:"Другое"})[a]||a,V=a=>({present:"Присутствовал",absent:"Пропуск",late:"Опоздание",excused:"Ув. причина"})[a]||a,b=a=>new Date(a)<new Date,F=(a,s)=>a==="completed"?s?"Сдан":"Не сдан":a==="in_progress"?"В процессе":"Назначен",E=(a,s)=>a==="completed"?s?"bg-success/10 text-success":"bg-danger/10 text-danger":a==="in_progress"?"bg-warning/10 text-warning":"bg-primary/10 text-primary",H=a=>{const s=new Date;return!(a.status==="completed"&&a.attempts_used>=a.max_attempts||a.start_date&&new Date(a.start_date)>s||a.end_date&&new Date(a.end_date)<s)};return Q(()=>{$()}),(a,s)=>{const c=U;return o(),d("div",O,[t("div",W,[T(c,{to:"/my-courses",class:"flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white"},{default:h(()=>[...s[0]||(s[0]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),m(" Назад к списку курсов ",-1)])]),_:1})]),j.value?(o(),d("div",X,[...s[1]||(s[1]=[t("div",{class:"h-10 w-10 animate-spin rounded-full border-4 border-solid border-primary border-t-transparent"},null,-1)])])):n.value?(o(),d("div",Z,[t("div",tt,[t("div",et,[t("div",null,[t("h2",st,r(n.value.info.course_name),1),t("p",at," Группа: "+r(n.value.info.group_name)+" • "+r(n.value.info.teacher_name||"Преподаватель не назначен"),1)]),t("div",rt,[t("span",{class:i(["rounded-full px-3 py-1 text-sm font-medium",n.value.info.status==="active"?"bg-success/10 text-success":n.value.info.status==="completed"?"bg-primary/10 text-primary":"bg-danger/10 text-danger"])},r(R(n.value.info.status)),3),t("span",ot,r(_(n.value.info.start_date))+" — "+r(_(n.value.info.end_date)),1)])]),t("div",dt,[t("div",nt,[s[3]||(s[3]=t("span",{class:"text-sm font-medium text-black dark:text-white"},"Прогресс обучения",-1)),t("span",it,r(n.value.info.progress)+"%",1)]),t("div",lt,[t("div",{class:"absolute left-0 h-full rounded-full bg-primary",style:q({width:`${n.value.info.progress}%`})},null,4)]),t("div",ut,[t("span",null,"Посещено: "+r(n.value.info.attended_lessons)+" / "+r(n.value.info.total_lessons)+" занятий",1)])])]),t("div",ct,[t("div",xt,[t("nav",mt,[(o(),d(y,null,f(M,e=>t("button",{key:e.id,onClick:A=>u.value=e.id,class:i(["rounded-md px-4 py-2 text-sm font-medium transition-all duration-200 whitespace-nowrap",u.value===e.id?"bg-primary text-white shadow-sm":"text-gray-600 hover:bg-white hover:text-gray-900 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"])},[m(r(e.label)+" ",1),e.id==="tests"&&g.value.length>0?(o(),d("span",{key:0,class:i(["ml-1.5 inline-flex items-center justify-center rounded-full bg-white/20 px-1.5 py-0.5 text-xs font-semibold",u.value===e.id?"text-white":"text-gray-600 dark:text-gray-400"])},r(g.value.length),3)):l("",!0),e.id==="documents"&&p.value.length>0?(o(),d("span",{key:1,class:i(["ml-1.5 inline-flex items-center justify-center rounded-full bg-white/20 px-1.5 py-0.5 text-xs font-semibold",u.value===e.id?"text-white":"text-gray-600 dark:text-gray-400"])},r(p.value.length),3)):l("",!0)],10,gt)),64))])]),t("div",pt,[k(t("div",bt,[t("div",yt,[s[4]||(s[4]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Программа курса",-1)),n.value.schedule.length===0?(o(),d("div",ft,"Расписание пока не составлено")):l("",!0),(o(!0),d(y,null,f(n.value.schedule,(e,A)=>(o(),d("div",{key:e.id,class:"relative flex gap-4 pb-6 last:pb-0 border-l border-gray-200 dark:border-gray-700 ml-3 pl-6"},[t("div",{class:i(["absolute -left-[5px] top-1 h-2.5 w-2.5 rounded-full border border-white dark:border-boxdark",{"bg-success":e.attendance_status==="present","bg-danger":e.attendance_status==="absent","bg-warning":e.attendance_status==="late","bg-primary":e.attendance_status==="excused","bg-gray-300 dark:bg-gray-600":!e.attendance_status&&b(e.start_time),"bg-blue-400":!e.attendance_status&&!b(e.start_time)}])},null,2),t("div",_t,[t("div",ht,[t("h4",kt,[m(r(e.title)+" ",1),e.event_type!=="theory"?(o(),d("span",vt,r(S(e.event_type)),1)):l("",!0)]),t("span",{class:i(["text-sm font-medium",b(e.start_time)?"text-gray-500":"text-primary"])},r(B(e.start_time)),3)]),t("p",wt,r(e.description||"Нет описания"),1),t("div",jt,[e.attendance_status?(o(),d("span",{key:0,class:i(["text-xs px-2 py-1 rounded font-medium",e.attendance_status==="present"?"bg-success/10 text-success":e.attendance_status==="absent"?"bg-danger/10 text-danger":e.attendance_status==="late"?"bg-warning/10 text-warning":"bg-primary/10 text-primary"])},r(V(e.attendance_status)),3)):b(e.start_time)?(o(),d("span",Dt," Нет статуса ")):l("",!0),e.grade!==null?(o(),d("span",Ct," Оценка: "+r(e.grade)+" / "+r(e.max_grade||100),1)):l("",!0)])])]))),128))])],512),[[v,u.value==="schedule"]]),k(t("div",Lt,[t("div",Bt,[s[6]||(s[6]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Тестирование",-1)),T(c,{to:"/tests/my",class:"text-sm text-primary hover:underline"},{default:h(()=>[...s[5]||(s[5]=[m("Все мои тесты",-1)])]),_:1})]),D.value?(o(),d("div",St,[...s[7]||(s[7]=[t("div",{class:"h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-t-transparent"},null,-1)])])):g.value.length===0?(o(),d("div",Vt,[...s[8]||(s[8]=[t("svg",{class:"w-12 h-12 mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("p",null,"Тесты пока не назначены",-1)])])):(o(),d("div",Tt,[(o(!0),d(y,null,f(g.value,e=>(o(),d("div",{key:e.id,class:"rounded-lg border border-gray-200 dark:border-gray-700 bg-white p-5 shadow-sm dark:bg-boxdark hover:shadow-md transition-shadow"},[t("div",zt,[t("div",null,[t("h4",Mt,r(e.template_name),1),t("span",$t,r(e.discipline_name||"Основной курс"),1)]),t("span",{class:i(["px-2 py-1 text-xs font-medium rounded",E(e.status,e.passed)])},r(F(e.status,e.passed)),3)]),t("div",Nt,[e.end_date?(o(),d("div",Rt,[s[9]||(s[9]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,"Дедлайн: "+r(B(e.end_date)),1)])):l("",!0),t("div",Ft,[s[10]||(s[10]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,"Попыток: "+r(e.attempts_used)+" / "+r(e.max_attempts),1)]),e.best_score!==null?(o(),d("div",Et,[s[11]||(s[11]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)),t("span",{class:i(e.passed?"text-success font-medium":"text-danger font-medium")}," Результат: "+r(e.best_score)+"% "+r(e.passed?"(Сдан)":"(Не сдан)"),3)])):l("",!0)]),e.status==="in_progress"?(o(),z(c,{key:0,to:`/tests/session/${e.active_session_id}`,class:"flex w-full justify-center rounded bg-primary p-2 font-medium text-gray hover:bg-opacity-90"},{default:h(()=>[...s[12]||(s[12]=[m(" Продолжить попытку ",-1)])]),_:1},8,["to"])):H(e)?(o(),z(c,{key:1,to:`/tests/start/${e.id}`,class:"flex w-full justify-center rounded bg-primary p-2 font-medium text-gray hover:bg-opacity-90"},{default:h(()=>[...s[13]||(s[13]=[m(" Начать тест ",-1)])]),_:1},8,["to"])):(o(),d("button",Ht," Недоступен "))]))),128))]))],512),[[v,u.value==="tests"]]),k(t("div",At,[s[15]||(s[15]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Сертификаты и документы",-1)),p.value.length===0?(o(),d("div",Ut,"Документов пока нет")):l("",!0),t("div",It,[(o(!0),d(y,null,f(p.value,e=>(o(),d("div",{key:e.id,class:"flex items-center justify-between rounded-lg border border-gray-200 dark:border-gray-700 bg-white p-4 shadow-sm dark:bg-boxdark"},[t("div",Pt,[s[14]||(s[14]=t("div",{class:"flex h-12 w-12 items-center justify-center rounded bg-primary/5 text-primary"},[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("div",null,[t("h4",Qt,"Сертификат "+r(e.certificate_number),1),t("p",qt,"Выдан: "+r(_(e.issue_date)),1)])]),t("a",{href:`/certificates/view/${e.uuid||""}`,target:"_blank",class:"rounded bg-primary px-4 py-2 text-sm font-medium text-white hover:bg-opacity-90"}," Скачать ",8,Gt)]))),128))])],512),[[v,u.value==="documents"]]),k(t("div",Jt,[s[18]||(s[18]=t("div",{class:"border-b border-gray-200 dark:border-gray-700 px-6 py-4"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Успеваемость")],-1)),t("div",Kt,[t("table",Ot,[s[17]||(s[17]=t("thead",null,[t("tr",{class:"bg-gray-2 text-left dark:bg-meta-4"},[t("th",{class:"min-w-[220px] py-4 px-4 font-medium text-black dark:text-white xl:pl-11"},"Занятие"),t("th",{class:"min-w-[150px] py-4 px-4 font-medium text-black dark:text-white"},"Дата"),t("th",{class:"min-w-[120px] py-4 px-4 font-medium text-black dark:text-white"},"Посещаемость"),t("th",{class:"py-4 px-4 font-medium text-black dark:text-white"},"Оценка")])],-1)),t("tbody",null,[L.value.length===0?(o(),d("tr",Wt,[...s[16]||(s[16]=[t("td",{colspan:"4",class:"py-5 px-4 pl-9 xl:pl-11 text-center text-gray-500"},"Оценок пока нет",-1)])])):l("",!0),(o(!0),d(y,null,f(L.value,e=>(o(),d("tr",{key:e.id},[t("td",Xt,[t("h5",Yt,r(e.title),1),t("span",Zt,r(S(e.event_type)),1)]),t("td",te,[t("p",ee,r(_(e.start_time)),1)]),t("td",se,[t("span",{class:i(["inline-flex rounded-full bg-opacity-10 py-1 px-3 text-sm font-medium",e.attendance_status==="present"?"bg-success text-success":e.attendance_status==="absent"?"bg-danger text-danger":e.attendance_status==="late"?"bg-warning text-warning":e.attendance_status==="excused"?"bg-primary text-primary":"bg-gray-100 text-gray-500"])},r(V(e.attendance_status)||"-"),3)]),t("td",ae,[e.grade!==null?(o(),d("span",re,r(e.grade)+" / "+r(e.max_grade||100),1)):(o(),d("span",oe,"-"))])]))),128))])])])],512),[[v,u.value==="grades"]])])])])):(o(),d("div",Y,[...s[2]||(s[2]=[t("h3",{class:"text-xl font-medium"},"Курс не найден",-1)])]))])}}};export{ge as default};
