import{_ as L}from"./BKg9m4wI.js";import{M as A,a as T}from"./DVCvjknM.js";import{u as U}from"./DlZaGH1J.js";import{v as $,r as m,g as O,q as H,c as s,a as t,h as w,i as l,d as x,n as i,t as d,F as _,j as C,l as N,b as S,w as D,o}from"./GLV6bXvn.js";import{u as I}from"./DVL-QcDc.js";import"./CFbq0LVm.js";import"./CRUGdXr-.js";const R={class:"container mx-auto px-4 py-6"},E={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6"},F=["disabled"],V={key:0,class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6"},G={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},K={class:"flex items-center gap-3"},P={class:"text-2xl font-bold text-gray-900 dark:text-white"},q={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-red-200 dark:border-red-800"},J={class:"flex items-center gap-3"},Q={class:"text-2xl font-bold text-red-600"},W={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-yellow-200 dark:border-yellow-800"},X={class:"flex items-center gap-3"},Y={class:"text-2xl font-bold text-yellow-600"},Z={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-green-200 dark:border-green-800"},tt={class:"flex items-center gap-3"},et={class:"text-2xl font-bold text-green-600"},rt={class:"flex gap-2 mb-6"},st=["onClick"],ot={key:1,class:"flex justify-center py-12"},nt={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-12 text-center"},lt={key:3,class:"space-y-3"},dt={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},at={class:"flex-1 min-w-0"},it={class:"flex items-start gap-4"},ut={class:"shrink-0 w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center"},gt={key:0,class:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ct={key:1,class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xt={key:2,class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},kt={key:3,class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},mt={key:4,class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pt={key:5,class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ht={class:"flex-1 min-w-0"},yt={class:"font-semibold text-gray-900 dark:text-white truncate"},vt={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},wt={key:0,class:"ml-2"},bt={class:"mt-2 flex items-center gap-3"},ft={class:"flex-1 max-w-[200px] bg-gray-200 dark:bg-gray-700 rounded-full h-2"},_t={class:"text-xs text-gray-500 dark:text-gray-400"},Ct={class:"flex items-center gap-4"},Mt={class:"text-right"},jt={key:0,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Bt={key:1,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},zt={key:2,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Lt={key:3,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},At={key:4,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Tt={key:5,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ft=$({__name:"pending",setup(Ut){const{authFetch:b}=U(),{error:M}=I(),c=m(!0),p=m([]),a=m(null),u=m("pending");async function h(){c.value=!0;try{const n=await b("/api/attendance/marking/status",{params:{onlyPending:u.value==="pending"?"true":void 0,status:u.value==="overdue"?"overdue":void 0}});n.success&&(p.value=n.statuses);const e=await b("/api/attendance/marking/pending");e.success&&(a.value=e.statistics)}catch(n){console.error("Error loading data:",n),M("Ошибка загрузки данных")}finally{c.value=!1}}function j(n){return n?new Date(n).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}function k(n){const e=new Date(n),y=new Date,r=e.getTime()-y.getTime();if(r<0){const z=Math.abs(r),v=Math.floor(z/(1e3*60*60));return v<24?{text:`Просрочено ${v}ч`,isOverdue:!0,isUrgent:!0}:{text:`Просрочено ${Math.floor(v/24)}д`,isOverdue:!0,isUrgent:!0}}const g=Math.floor(r/(1e3*60*60));return g<2?{text:`Осталось ${g}ч`,isOverdue:!1,isUrgent:!0}:g<24?{text:`Осталось ${g}ч`,isOverdue:!1,isUrgent:!1}:{text:`Осталось ${Math.floor(g/24)}д`,isOverdue:!1,isUrgent:!1}}function B(n){const e=k(n.deadline);return n.status==="overdue"?"border-l-4 border-red-500 bg-red-50 dark:bg-red-900/10":e.isOverdue||n.status==="late"?"border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/10":e.isUrgent?"border-l-4 border-orange-500 bg-orange-50 dark:bg-orange-900/10":"border-l-4 border-transparent"}function f(n){return n.studentsCount===0?0:Math.round(n.markedCount/n.studentsCount*100)}return O(()=>{h()}),H(u,()=>{h()}),(n,e)=>{const y=L;return o(),s("div",R,[t("div",E,[e[2]||(e[2]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Отметка посещаемости "),t("p",{class:"text-gray-500 dark:text-gray-400 mt-1"}," Занятия, требующие отметки посещаемости ")],-1)),t("button",{onClick:h,disabled:l(c),class:"mt-4 sm:mt-0 inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[(o(),s("svg",{class:i(["w-4 h-4",{"animate-spin":l(c)}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[0]||(e[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),e[1]||(e[1]=x(" Обновить ",-1))],8,F)]),l(a)?(o(),s("div",V,[t("div",G,[t("div",K,[e[4]||(e[4]=t("div",{class:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg"},[t("svg",{class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",null,[t("p",P,d(l(a).pending),1),e[3]||(e[3]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Ожидают",-1))])])]),t("div",q,[t("div",J,[e[6]||(e[6]=t("div",{class:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg"},[t("svg",{class:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",null,[t("p",Q,d(l(a).overdue),1),e[5]||(e[5]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Просрочено",-1))])])]),t("div",W,[t("div",X,[e[8]||(e[8]=t("div",{class:"p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg"},[t("svg",{class:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),t("div",null,[t("p",Y,d(l(a).late),1),e[7]||(e[7]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"С опозданием",-1))])])]),t("div",Z,[t("div",tt,[e[10]||(e[10]=t("div",{class:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg"},[t("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",null,[t("p",et,d(l(a).onTime),1),e[9]||(e[9]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Вовремя",-1))])])])])):w("",!0),t("div",rt,[(o(!0),s(_,null,C([{value:"pending",label:"Ожидают",count:l(a)?.pending},{value:"overdue",label:"Просрочено",count:l(a)?.overdue},{value:"all",label:"Все"}],r=>(o(),s("button",{key:r.value,onClick:g=>u.value=r.value,class:i([l(u)===r.value?"bg-primary-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300","px-4 py-2 rounded-lg text-sm font-medium border border-gray-200 dark:border-gray-700 transition-colors"])},[x(d(r.label)+" ",1),r.count&&r.count>0?(o(),s("span",{key:0,class:i(["ml-1 px-1.5 py-0.5 text-xs rounded-full",l(u)===r.value?"bg-white/20":r.value==="overdue"?"bg-red-100 text-red-600":"bg-gray-100 dark:bg-gray-700"])},d(r.count),3)):w("",!0)],10,st))),128))]),l(c)?(o(),s("div",ot,[...e[11]||(e[11]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary-600"},null,-1)])])):l(p).length===0?(o(),s("div",nt,[...e[12]||(e[12]=[t("svg",{class:"w-16 h-16 mx-auto mb-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("p",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"}," Все занятия отмечены ",-1),t("p",{class:"text-gray-500 dark:text-gray-400"}," Нет занятий, требующих отметки посещаемости ",-1)])])):(o(),s("div",lt,[(o(!0),s(_,null,C(l(p),r=>(o(),s("div",{key:r.id,class:i([B(r),"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 transition-all hover:shadow-md"])},[t("div",dt,[t("div",at,[t("div",it,[t("div",ut,[r.status==="pending"?(o(),s("svg",gt,[...e[13]||(e[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):r.status==="in_progress"?(o(),s("svg",ct,[...e[14]||(e[14]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"},null,-1)])])):r.status==="on_time"?(o(),s("svg",xt,[...e[15]||(e[15]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):r.status==="late"?(o(),s("svg",kt,[...e[16]||(e[16]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])])):r.status==="overdue"?(o(),s("svg",mt,[...e[17]||(e[17]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(o(),s("svg",pt,[...e[18]||(e[18]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},null,-1)])]))]),t("div",ht,[t("h3",yt,d(r.event?.title||"Занятие"),1),t("p",vt,[x(d(j(r.event?.endTime??null))+" ",1),r.event?.groupCode?(o(),s("span",wt," • "+d(r.event.groupCode),1)):w("",!0)]),t("div",bt,[t("div",ft,[t("div",{class:i(["h-2 rounded-full transition-all",f(r)===100?"bg-green-500":"bg-primary-500"]),style:N({width:`${f(r)}%`})},null,6)]),t("span",_t,d(r.markedCount)+"/"+d(r.studentsCount)+" студентов ",1)])])])]),t("div",Ct,[t("div",Mt,[t("span",{class:i([l(A)[r.status],"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full"])},[r.status==="pending"?(o(),s("svg",jt,[...e[19]||(e[19]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):r.status==="in_progress"?(o(),s("svg",Bt,[...e[20]||(e[20]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"},null,-1)])])):r.status==="on_time"?(o(),s("svg",zt,[...e[21]||(e[21]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):r.status==="late"?(o(),s("svg",Lt,[...e[22]||(e[22]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])])):r.status==="overdue"?(o(),s("svg",At,[...e[23]||(e[23]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(o(),s("svg",Tt,[...e[24]||(e[24]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},null,-1)])])),x(" "+d(l(T)[r.status]),1)],2),t("p",{class:i(["text-xs mt-1",k(r.deadline).isOverdue?"text-red-600 font-medium":k(r.deadline).isUrgent?"text-orange-600":"text-gray-500"])},d(k(r.deadline).text),3)]),S(y,{to:`/groups/journal/${r.event?.groupId}_${r.event?.disciplineId}?eventId=${r.scheduleEventId}`,class:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white text-sm font-medium rounded-lg transition-colors"},{default:D(()=>[...e[25]||(e[25]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),x(" Отметить ",-1)])]),_:1},8,["to"])])])],2))),128))]))])}}});export{Ft as default};
