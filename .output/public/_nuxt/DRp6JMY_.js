import{v as F,u as S,r as c,f as x,g as E,c as o,a as t,i,F as y,h as p,t as n,x as b,D as w,H as _,j as C,n as M,d as j,o as a}from"./GLV6bXvn.js";import{u as L}from"./DlZaGH1J.js";import{u as U}from"./DVL-QcDc.js";import"./CFbq0LVm.js";import"./CRUGdXr-.js";const $={class:"mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10"},P={key:0,class:"flex justify-center items-center py-20"},R={key:0,class:"mb-6 grid grid-cols-2 sm:grid-cols-4 gap-4"},Y={class:"bg-white dark:bg-boxdark rounded-lg p-4 shadow-sm"},T={class:"text-2xl font-bold text-gray-900 dark:text-white"},q={class:"bg-white dark:bg-boxdark rounded-lg p-4 shadow-sm"},G={class:"text-2xl font-bold text-success"},I={class:"bg-white dark:bg-boxdark rounded-lg p-4 shadow-sm"},J={class:"text-2xl font-bold text-warning"},K={class:"bg-white dark:bg-boxdark rounded-lg p-4 shadow-sm"},O={class:"text-2xl font-bold text-danger"},Q={class:"mb-6 flex flex-wrap gap-4"},W={class:"flex items-center gap-2"},X={class:"flex items-center gap-2"},Z=["value"],tt={key:1,class:"flex flex-col items-center justify-center py-20 rounded-xl bg-white dark:bg-boxdark shadow-md"},et={class:"text-lg font-semibold text-gray-600 dark:text-gray-400"},st={class:"text-sm text-gray-500 dark:text-gray-500 mt-1"},rt={key:2,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},ot={class:"relative aspect-[1.4/1] bg-linear-to-br from-primary/10 to-primary/5 dark:from-primary/20 dark:to-primary/10 flex items-center justify-center overflow-hidden"},at={class:"p-4"},it={class:"font-semibold text-gray-900 dark:text-white line-clamp-2 mb-2"},nt={key:0,class:"text-xs text-primary dark:text-primary/80 font-medium mb-1"},lt={class:"text-sm text-gray-500 dark:text-gray-400 mb-3"},dt={key:0},ut={key:1},gt={key:2},pt={key:3},xt={class:"flex flex-wrap gap-x-4 gap-y-2 text-xs text-gray-500 dark:text-gray-400"},ct={class:"flex items-center gap-1"},mt={key:0,class:"flex items-center gap-1"},ft={key:1,class:"flex items-center gap-1"},yt=["href"],kt={key:2,class:"mt-4 w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 cursor-not-allowed"},Mt=F({__name:"my-certificates",setup(vt){S({title:"Мои сертификаты"});const{authFetch:A}=L(),{error:D}=U(),m=c(!0),l=c([]),d=c(""),u=c(""),B=x(()=>{const r=new Set;return l.value.forEach(e=>{const s=new Date(e.issuedAt),f=`${String(s.getMonth()+1).padStart(2,"0")}.${s.getFullYear()}`;r.add(f)}),Array.from(r).sort().reverse()}),k=x(()=>{let r=[...l.value];if(d.value&&(r=r.filter(e=>e.status===d.value)),u.value){const[e,s]=u.value.split(".").map(Number);r=r.filter(f=>{const h=new Date(f.issuedAt);return h.getMonth()+1===e&&h.getFullYear()===s})}return r}),V=x(()=>l.value.filter(r=>r.status==="issued"&&!g(r)).length),H=x(()=>l.value.filter(r=>r.status==="issued"&&g(r)).length),N=x(()=>l.value.filter(r=>r.status==="revoked").length),v=r=>r?new Date(r).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}):"—",g=r=>r.expiresAt?new Date(r.expiresAt)<new Date:!1,z=async()=>{m.value=!0;try{const r=await A("/api/certificates/my");r.success&&(l.value=r.certificates)}catch(r){console.error("Error loading certificates:",r),D(r.message||"Ошибка загрузки сертификатов")}finally{m.value=!1}};return E(()=>{z()}),(r,e)=>(a(),o("div",$,[e[18]||(e[18]=t("div",{class:"mb-6"},[t("h2",{class:"text-title-md2 font-bold text-black dark:text-white"}," Мои сертификаты "),t("p",{class:"mt-1 text-gray-500 dark:text-gray-400"}," Просмотр и скачивание полученных сертификатов ")],-1)),i(m)?(a(),o("div",P,[...e[2]||(e[2]=[t("div",{class:"h-12 w-12 animate-spin rounded-full border-4 border-solid border-primary border-t-transparent"},null,-1)])])):(a(),o(y,{key:1},[i(l).length>0?(a(),o("div",R,[t("div",Y,[e[3]||(e[3]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Всего",-1)),t("p",T,n(i(l).length),1)]),t("div",q,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Действительных",-1)),t("p",G,n(i(V)),1)]),t("div",I,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Истёк срок",-1)),t("p",J,n(i(H)),1)]),t("div",K,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Отозванных",-1)),t("p",O,n(i(N)),1)])])):p("",!0),t("div",Q,[t("div",W,[e[8]||(e[8]=t("label",{class:"text-sm text-gray-600 dark:text-gray-400"},"Статус:",-1)),b(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>_(d)?d.value=s:null),class:"rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-gray-900 dark:text-white focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},[...e[7]||(e[7]=[t("option",{value:""},"Все",-1),t("option",{value:"issued"},"Выданные",-1),t("option",{value:"revoked"},"Отозванные",-1)])],512),[[w,i(d)]])]),t("div",X,[e[10]||(e[10]=t("label",{class:"text-sm text-gray-600 dark:text-gray-400"},"Период:",-1)),b(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>_(u)?u.value=s:null),class:"rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-gray-900 dark:text-white focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},[e[9]||(e[9]=t("option",{value:""},"Все",-1)),(a(!0),o(y,null,C(i(B),s=>(a(),o("option",{key:s,value:s},n(s),9,Z))),128))],512),[[w,i(u)]])])]),i(k).length===0?(a(),o("div",tt,[e[11]||(e[11]=t("svg",{class:"w-20 h-20 text-gray-300 dark:text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1)),t("h3",et,n(i(d)||i(u)?"Сертификаты не найдены":"У вас пока нет сертификатов"),1),t("p",st,n(i(d)||i(u)?"Попробуйте изменить фильтры":"После прохождения обучения здесь появятся ваши сертификаты"),1)])):(a(),o("div",rt,[(a(!0),o(y,null,C(i(k),s=>(a(),o("div",{key:s.id,class:"group rounded-xl bg-white dark:bg-boxdark shadow-md overflow-hidden hover:shadow-lg transition-all duration-300"},[t("div",ot,[e[12]||(e[12]=t("svg",{class:"w-24 h-24 text-primary/40 transform group-hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1)),t("div",{class:M(["absolute top-3 right-3 px-3 py-1 rounded-full text-xs font-medium",s.status==="issued"&&!g(s)?"bg-success/20 text-success":s.status==="issued"&&g(s)?"bg-warning/20 text-warning":"bg-danger/20 text-danger"])},n(s.status==="issued"?g(s)?"Истёк срок":"Действителен":"Отозван"),3)]),t("div",at,[t("h3",it,n(s.courseName),1),s.certificateNumber?(a(),o("p",nt," № "+n(s.certificateNumber),1)):p("",!0),t("p",lt,[s.groupCode?(a(),o("span",dt,"Группа: "+n(s.groupCode),1)):p("",!0),s.groupCode&&s.courseHours?(a(),o("span",ut," · ")):p("",!0),s.courseHours?(a(),o("span",gt,n(s.courseHours)+" ч.",1)):p("",!0),!s.groupCode&&!s.courseHours?(a(),o("span",pt,"—")):p("",!0)]),t("div",xt,[t("div",ct,[e[13]||(e[13]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),t("span",null,"Выдан: "+n(v(s.issuedAt)),1)]),s.expiresAt?(a(),o("div",mt,[e[14]||(e[14]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",{class:M({"text-warning":g(s)})}," До: "+n(v(s.expiresAt)),3)])):(a(),o("div",ft,[...e[15]||(e[15]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),t("span",null,"Бессрочный",-1)])]))]),s.status==="issued"&&s.id?(a(),o("a",{key:1,href:`/api/certificates/download/${s.id}`,target:"_blank",class:"mt-4 w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-colors"},[...e[16]||(e[16]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),j(" Скачать сертификат ",-1)])],8,yt)):(a(),o("div",kt,[...e[17]||(e[17]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})],-1),j(" Сертификат отозван ",-1)])]))])]))),128))]))],64))]))}});export{Mt as default};
