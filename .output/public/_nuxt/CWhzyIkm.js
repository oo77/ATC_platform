import{_ as L}from"./BMofnORk.js";import{_ as N}from"./BjHlhNFN.js";import{v as H,s as R,r as p,f as T,g as E,c as d,a as t,b as q,k as J,h as m,i as s,w as K,t as l,n as h,d as u,x as w,A as O,D,F as j,j as B,o as n}from"./GLV6bXvn.js";import{u as Q}from"./DlZaGH1J.js";import{u as W}from"./DW2J_Y_n.js";import"./CyDLpZDf.js";import"./DVL-QcDc.js";import"./CFbq0LVm.js";import"./CRUGdXr-.js";const X={class:"mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10"},Y={class:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Z={class:"grid grid-cols-1 gap-4 md:grid-cols-4 mb-6"},tt={class:"rounded-lg bg-white dark:bg-boxdark p-6 shadow-md"},et={class:"flex items-center gap-4"},st={class:"text-2xl font-bold text-black dark:text-white"},rt={class:"rounded-lg bg-white dark:bg-boxdark p-6 shadow-md"},ot={class:"flex items-center gap-4"},at={class:"text-2xl font-bold text-black dark:text-white"},it={class:"rounded-lg bg-white dark:bg-boxdark p-6 shadow-md"},nt={class:"flex items-center gap-4"},dt={class:"text-2xl font-bold text-black dark:text-white"},lt={class:"rounded-lg bg-white dark:bg-boxdark p-6 shadow-md"},ut={class:"flex items-center gap-4"},ct={class:"text-2xl font-bold text-black dark:text-white"},pt={class:"mb-6 border-b border-stroke dark:border-strokedark"},mt={class:"flex gap-6"},xt={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-primary rounded-t-sm"},gt={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-primary rounded-t-sm"},vt={class:"bg-white dark:bg-boxdark rounded-xl shadow-md p-6 mb-6"},kt={class:"flex items-center gap-3 mb-4"},yt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ft={class:"relative"},bt={class:"relative"},ht=["value"],wt={key:0},_t={class:"relative"},Ct={class:"rounded-lg bg-white dark:bg-boxdark shadow-md overflow-hidden"},Mt={key:0,class:"p-12 text-center"},At={key:1,class:"p-12 text-center text-gray-500 dark:text-gray-400"},Dt={key:0,class:"mt-2"},jt={key:1,class:"mt-2"},Bt={key:2,class:"overflow-x-auto"},St={class:"w-full"},zt={class:"divide-y divide-gray-200 dark:divide-gray-700"},It=["onClick"],Vt={class:"px-6 py-4"},$t={class:"flex items-center gap-3"},Ft={class:"flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary font-semibold"},Pt={class:"font-medium text-gray-900 dark:text-white"},Ut={class:"px-6 py-4"},Gt={key:0},Lt={class:"font-medium text-gray-900 dark:text-white"},Nt={class:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs"},Ht={key:1,class:"text-gray-400"},Rt={class:"px-6 py-4"},Tt={class:"text-sm"},Et={class:"text-gray-900 dark:text-white"},qt={class:"text-gray-500 dark:text-gray-400"},Jt={class:"px-6 py-4"},Kt={class:"inline-flex items-center rounded-full bg-gray-100 dark:bg-gray-700 px-2.5 py-0.5 text-sm font-medium text-gray-800 dark:text-gray-200"},Ot={class:"px-6 py-4"},Qt={key:3,class:"border-t border-gray-200 dark:border-gray-700 px-6 py-4"},Wt={class:"flex items-center justify-between"},Xt={class:"text-sm text-gray-700 dark:text-gray-300"},Yt={class:"font-medium"},Zt={class:"font-medium"},te={class:"font-medium"},ee={class:"flex gap-2"},se=["disabled"],re=["disabled"],ge=H({__name:"index",setup(oe){const{authFetch:_}=Q(),S=R(),{canCreateGroups:z}=W(),y=p(!1),f=p([]),C=p([]),k=p(!1),i=p({page:1,limit:10,total:0,totalPages:0}),x=p({total:0,active:0,completed:0,totalStudents:0}),a=p({search:"",courseId:"",isActive:void 0,isArchived:!1}),I=T(()=>a.value.search!==""||a.value.courseId!==""||a.value.isActive!==void 0),c=async()=>{y.value=!0;try{const r=new URLSearchParams({page:i.value.page.toString(),limit:i.value.limit.toString(),isArchived:a.value.isArchived.toString()});a.value.search&&r.append("search",a.value.search),a.value.courseId&&r.append("courseId",a.value.courseId),a.value.isActive!==void 0&&r.append("isActive",a.value.isActive.toString());const e=await _(`/api/groups?${r.toString()}`);e.success&&(f.value=e.groups,i.value.total=e.total,i.value.totalPages=e.totalPages,e.stats&&(x.value=e.stats))}catch(r){console.error("Ошибка загрузки групп:",r)}finally{y.value=!1}},V=async()=>{try{const r=await _("/api/courses",{params:{limit:1e3,isActive:!0}});r.success&&r.courses&&(C.value=r.courses)}catch(r){console.error("Error loading courses:",r)}},b=()=>{i.value.page=1,c()},$=()=>{a.value.search="",a.value.courseId="",a.value.isActive=void 0,i.value.page=1,c()},M=r=>{i.value.page=r,c()},F=r=>{S.push(`/groups/${r.id}`)},P=()=>{k.value=!1,c()},A=r=>new Date(r).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}),U=r=>{if(r.isArchived)return"bg-gray-100 dark:bg-gray-700 text-gray-500";const e=new Date,g=new Date(r.endDate),v=new Date(r.startDate);return r.isActive?g<e?"bg-warning/10 text-warning":v>e?"bg-info/10 text-info":"bg-success/10 text-success":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"},G=r=>{if(r.isArchived)return"Архив";const e=new Date,g=new Date(r.endDate),v=new Date(r.startDate);return r.isActive?g<e?"Завершена":v>e?"Ожидает":"Активна":"Неактивна"};return E(()=>{c(),V()}),(r,e)=>{const g=L,v=N;return n(),d("div",X,[t("div",Y,[e[10]||(e[10]=t("h2",{class:"text-title-md2 font-bold text-black dark:text-white"}," Учебные группы ",-1)),s(z)?(n(),J(g,{key:0,onClick:e[0]||(e[0]=o=>k.value=!0),class:"flex items-center gap-2"},{default:K(()=>[...e[9]||(e[9]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Создать группу ",-1)])]),_:1})):m("",!0)]),t("div",Z,[t("div",tt,[t("div",et,[e[12]||(e[12]=t("div",{class:"flex h-12 w-12 items-center justify-center rounded-full bg-primary/10"},[t("svg",{class:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),t("div",null,[e[11]||(e[11]=t("h3",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"}," Всего групп ",-1)),t("p",st,l(s(x).total),1)])])]),t("div",rt,[t("div",ot,[e[14]||(e[14]=t("div",{class:"flex h-12 w-12 items-center justify-center rounded-full bg-success/10"},[t("svg",{class:"w-6 h-6 text-success",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",null,[e[13]||(e[13]=t("h3",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"}," Активных ",-1)),t("p",at,l(s(x).active),1)])])]),t("div",it,[t("div",nt,[e[16]||(e[16]=t("div",{class:"flex h-12 w-12 items-center justify-center rounded-full bg-warning/10"},[t("svg",{class:"w-6 h-6 text-warning",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t("div",null,[e[15]||(e[15]=t("h3",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"}," Завершённых ",-1)),t("p",dt,l(s(x).completed),1)])])]),t("div",lt,[t("div",ut,[e[18]||(e[18]=t("div",{class:"flex h-12 w-12 items-center justify-center rounded-full bg-info/10"},[t("svg",{class:"w-6 h-6 text-info",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),t("div",null,[e[17]||(e[17]=t("h3",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"}," Слушателей ",-1)),t("p",ct,l(s(x).totalStudents),1)])])])]),t("div",pt,[t("div",mt,[t("button",{onClick:e[1]||(e[1]=o=>{s(a).isArchived=!1,c()}),class:h(["pb-3 text-sm font-medium transition-colors relative",s(a).isArchived?"text-gray-500 hover:text-primary":"text-primary"])},[e[19]||(e[19]=u(" Текущие группы ",-1)),s(a).isArchived?m("",!0):(n(),d("span",xt))],2),t("button",{onClick:e[2]||(e[2]=o=>{s(a).isArchived=!0,c()}),class:h(["pb-3 text-sm font-medium transition-colors relative",s(a).isArchived?"text-primary":"text-gray-500 hover:text-primary"])},[e[20]||(e[20]=u(" Архив групп ",-1)),s(a).isArchived?(n(),d("span",gt)):m("",!0)],2)])]),t("div",vt,[t("div",kt,[e[22]||(e[22]=t("div",{class:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})])],-1)),e[23]||(e[23]=t("h4",{class:"text-lg font-semibold text-black dark:text-white"}," Фильтры ",-1)),s(I)?(n(),d("button",{key:0,onClick:$,class:"ml-auto text-sm text-primary hover:text-primary/80 transition-colors flex items-center gap-1"},[...e[21]||(e[21]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),u(" Сбросить фильтры ",-1)])])):m("",!0)]),t("div",yt,[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Поиск ",-1)),t("div",ft,[w(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s(a).search=o),type:"text",placeholder:"Код группы, курс...",class:"w-full rounded-lg border border-stroke bg-transparent py-2 pl-10 pr-4 outline-none focus:border-primary dark:border-strokedark dark:bg-meta-4 dark:focus:border-primary",onInput:b},null,544),[[O,s(a).search]]),e[24]||(e[24]=t("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Учебная программа ",-1)),t("div",bt,[w(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>s(a).courseId=o),class:"w-full rounded-lg border border-stroke bg-transparent py-2 pl-4 pr-10 outline-none focus:border-primary dark:border-strokedark dark:bg-meta-4 dark:focus:border-primary appearance-none",onChange:b},[e[26]||(e[26]=t("option",{value:""},"Все программы",-1)),(n(!0),d(j,null,B(s(C),o=>(n(),d("option",{key:o.id,value:o.id},l(o.shortName)+" - "+l(o.name),9,ht))),128))],544),[[D,s(a).courseId]]),e[27]||(e[27]=t("svg",{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),s(a).isArchived?m("",!0):(n(),d("div",wt,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Статус (Активность) ",-1)),t("div",_t,[w(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>s(a).isActive=o),class:"w-full rounded-lg border border-stroke bg-transparent py-2 pl-4 pr-10 outline-none focus:border-primary dark:border-strokedark dark:bg-meta-4 dark:focus:border-primary appearance-none",onChange:b},[...e[29]||(e[29]=[t("option",{value:void 0},"Все",-1),t("option",{value:!0},"Активные",-1),t("option",{value:!1},"Неактивные",-1)])],544),[[D,s(a).isActive]]),e[30]||(e[30]=t("svg",{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]))])]),t("div",Ct,[s(y)?(n(),d("div",Mt,[...e[32]||(e[32]=[t("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent"},null,-1),t("p",{class:"mt-4 text-gray-600 dark:text-gray-400"}," Загрузка учебных групп... ",-1)])])):s(f).length===0?(n(),d("div",At,[e[33]||(e[33]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),e[34]||(e[34]=t("p",{class:"mt-4 text-lg font-medium"},"Учебные группы не найдены",-1)),s(a).isArchived?(n(),d("p",jt,"В архиве пока нет групп")):(n(),d("p",Dt,' Создайте первую группу, нажав кнопку "Создать группу" '))])):(n(),d("div",Bt,[t("table",St,[e[35]||(e[35]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"},[t("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Группа "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Учебная программа "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Даты обучения "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Слушатели "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Статус ")])],-1)),t("tbody",zt,[(n(!0),d(j,null,B(s(f),o=>(n(),d("tr",{key:o.id,onClick:ae=>F(o),class:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer"},[t("td",Vt,[t("div",$t,[t("div",Ft,l(o.code.substring(0,2).toUpperCase()),1),t("div",Pt,l(o.code),1)])]),t("td",Ut,[o.course?(n(),d("div",Gt,[t("div",Lt,l(o.course.shortName),1),t("div",Nt,l(o.course.name),1)])):(n(),d("span",Ht,"—"))]),t("td",Rt,[t("div",Tt,[t("div",Et,l(A(o.startDate)),1),t("div",qt," — "+l(A(o.endDate)),1)])]),t("td",Jt,[t("span",Kt,l(o.studentCount||0),1)]),t("td",Ot,[t("span",{class:h(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",U(o)])},l(G(o)),3)])],8,It))),128))])])])),s(i).totalPages>1?(n(),d("div",Qt,[t("div",Wt,[t("div",Xt,[e[36]||(e[36]=u(" Показано ",-1)),t("span",Yt,l((s(i).page-1)*s(i).limit+1),1),e[37]||(e[37]=u(" - ",-1)),t("span",Zt,l(Math.min(s(i).page*s(i).limit,s(i).total)),1),e[38]||(e[38]=u(" из ",-1)),t("span",te,l(s(i).total),1),e[39]||(e[39]=u(" групп ",-1))]),t("div",ee,[t("button",{onClick:e[6]||(e[6]=o=>M(s(i).page-1)),disabled:s(i).page===1,class:"rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700"}," Назад ",8,se),t("button",{onClick:e[7]||(e[7]=o=>M(s(i).page+1)),disabled:s(i).page>=s(i).totalPages,class:"rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700"}," Вперёд ",8,re)])])])):m("",!0)]),q(v,{"is-open":s(k),onClose:e[8]||(e[8]=o=>k.value=!1),onCreated:P},null,8,["is-open"])])}}});export{ge as default};
