import{_ as M}from"./BMofnORk.js";import{_ as F}from"./CyDLpZDf.js";import{u as I}from"./DlZaGH1J.js";import{r as c,q as b,k as N,o,w as v,a as e,c as d,t as g,F as O,j as S,n as _,h as V,d as p,b as w}from"./GLV6bXvn.js";const A={class:"space-y-6"},$={key:0,class:"py-8 text-center"},T={key:1,class:"py-6 text-center"},U={class:"text-sm text-danger"},q={key:2,class:"space-y-3"},D=["onClick"],E={key:0,class:"w-2 h-2 rounded-full bg-white"},G={class:"text-2xl"},H={class:"flex-1"},J={class:"block font-medium text-gray-900 dark:text-white"},K=["value","checked"],P={class:"flex gap-3 justify-end"},Z={__name:"TestsLanguageSelectModal",props:{isOpen:{type:Boolean,default:!1},assignmentId:{type:String,default:null},customLanguages:{type:Array,default:null}},emits:["close","confirm"],setup(f,{emit:C}){const l=f,h=C,{authFetch:L}=I(),m=c(!1),i=c(null),n=c([]),a=c(null),u=c(!1);b(()=>l.isOpen,async t=>{t&&(a.value=null,l.customLanguages?(n.value=l.customLanguages,n.value.length===1&&(a.value=n.value[0].value)):l.assignmentId&&await k())});const k=async()=>{if(l.assignmentId){m.value=!0,i.value=null;try{const t=await L(`/api/tests/assignments/${l.assignmentId}/available-languages`);t.success?(n.value=t.languages||[],n.value.length===1&&(a.value=n.value[0].value),n.value.length===0&&(i.value="Для этого теста нет доступных языков. Обратитесь к администратору.")):i.value=t.message||"Не удалось загрузить языки"}catch(t){console.error("Ошибка загрузки языков:",t),i.value="Произошла ошибка при загрузке языков"}finally{m.value=!1}}},B=t=>{a.value=t},j=()=>{a.value&&(u.value=!0,h("confirm",a.value))};b(()=>l.isOpen,t=>{t||(u.value=!1)});const y=()=>{u.value||h("close")};return(t,s)=>{const x=M,z=F;return o(),N(z,{"is-open":f.isOpen,title:"Выберите язык тестирования",size:"sm",onClose:y},{footer:v(()=>[e("div",P,[w(x,{variant:"outline",onClick:y,disabled:u.value},{default:v(()=>[...s[4]||(s[4]=[p(" Отмена ",-1)])]),_:1},8,["disabled"]),w(x,{onClick:j,disabled:!a.value||u.value,loading:u.value},{default:v(()=>[...s[5]||(s[5]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),p(" Подтвердить и начать ",-1)])]),_:1},8,["disabled","loading"])])]),default:v(()=>[e("div",A,[s[2]||(s[2]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Выберите язык, на котором хотите проходить тест. После выбора язык изменить будет невозможно. ",-1)),m.value?(o(),d("div",$,[...s[0]||(s[0]=[e("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," Загрузка доступных языков... ",-1)])])):i.value?(o(),d("div",T,[s[1]||(s[1]=e("div",{class:"w-12 h-12 rounded-full bg-danger/10 flex items-center justify-center mx-auto mb-3"},[e("svg",{class:"w-6 h-6 text-danger",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("p",U,g(i.value),1),e("button",{onClick:k,class:"mt-3 text-sm text-primary hover:underline"}," Попробовать снова ")])):(o(),d("div",q,[(o(!0),d(O,null,S(n.value,r=>(o(),d("label",{key:r.value,onClick:Q=>B(r.value),class:_(["flex items-center gap-4 p-4 rounded-xl border-2 cursor-pointer transition-all duration-200",a.value===r.value?"border-primary bg-primary/5 shadow-md":"border-gray-200 dark:border-gray-700 hover:border-primary/50 hover:bg-gray-50 dark:hover:bg-meta-4"])},[e("div",{class:_(["shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all",a.value===r.value?"border-primary bg-primary":"border-gray-300 dark:border-gray-600"])},[a.value===r.value?(o(),d("div",E)):V("",!0)],2),e("span",G,g(r.flag),1),e("div",H,[e("span",J,g(r.label),1)]),e("input",{type:"radio",name:"language",value:r.value,checked:a.value===r.value,class:"sr-only"},null,8,K)],10,D))),128))])),s[3]||(s[3]=e("div",{class:"flex items-start gap-3 p-3 rounded-lg bg-warning/10 border border-warning/20"},[e("svg",{class:"w-5 h-5 text-warning shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("p",{class:"text-sm text-gray-700 dark:text-gray-300"},[e("span",{class:"font-medium text-warning"},"Внимание!"),p(" После начала теста изменить язык будет невозможно. ")])],-1))])]),_:1},8,["is-open"])}}};export{Z as _};
