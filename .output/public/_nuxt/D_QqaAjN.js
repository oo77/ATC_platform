import{_ as et}from"./BKg9m4wI.js";import{r as S,f as B,v as Y,c as o,a as t,t as i,d as j,l as q,o as a,b as I,h as b,z as K,n as _,T as Q,w as O,F as A,j as P,m as W,x as U,A as H,g as st,k as rt,i as v}from"./GLV6bXvn.js";import{u as at}from"./DlZaGH1J.js";import{u as X}from"./DVL-QcDc.js";import{_ as E}from"./DlAUqK2U.js";import"./CFbq0LVm.js";import"./CRUGdXr-.js";const ot=()=>{const{authFetch:l}=at(),p=X(),d=S([]),w=S(1),m=S({totalFiles:0,analyzedFiles:0,readyFiles:0,errorFiles:0,totalCost:"0.00",totalTime:0}),y=S(!1),h=S(null),x=()=>{d.value=[],w.value=1,m.value={totalFiles:0,analyzedFiles:0,readyFiles:0,errorFiles:0,totalCost:"0.00",totalTime:0},y.value=!1,h.value=null},r=x,e=async c=>{if(c.length===0){p.error("Выберите файлы для загрузки");return}if(c.length>20){p.error("Максимум 20 файлов за раз");return}y.value=!0,h.value=null;try{const n=new FormData;c.forEach(k=>{n.append("files",k)});const u=await l("/api/ai-certificates/batch/upload",{method:"POST",body:n});return d.value=u.files.map(k=>({file:k,analysisResult:null,selectedStudent:null,uiStatus:"uploaded",isExpanded:!1})),m.value.totalFiles=u.successCount,u.errorCount>0?p.warning(`Загружено ${u.successCount} из ${c.length} файлов`):p.success(`Успешно загружено ${u.successCount} файлов`),w.value=2,u}catch(n){const u=n.data?.message||n.message||"Ошибка загрузки файлов";throw h.value=u,p.error(u),n}finally{y.value=!1}},s=async()=>{if(d.value.length===0){h.value="Нет файлов для анализа";return}y.value=!0,h.value=null,d.value.forEach(c=>{c.uiStatus="analyzing"});try{const c=d.value.map(u=>u.file.fileId),n=await l("/api/ai-certificates/batch/analyze",{method:"POST",body:{fileIds:c}});return n.results.forEach(u=>{const k=d.value.find(M=>M.file.fileId===u.fileId);if(k)if(k.analysisResult=u,u.success){if(k.uiStatus="analyzed",u.matchResult?.topAlternatives&&u.matchResult.topAlternatives.length>0){const M=u.matchResult.topAlternatives[0];M&&(k.selectedStudent=M.student,k.uiStatus="ready")}}else k.uiStatus="error"}),m.value.analyzedFiles=n.successCount,m.value.errorFiles=n.errorCount,m.value.totalCost=n.totalCost,m.value.totalTime=n.totalProcessingTime,m.value.readyFiles=d.value.filter(u=>u.uiStatus==="ready").length,n.errorCount>0?p.warning(`Проанализировано ${n.successCount} из ${d.value.length} файлов`):p.success(`Успешно проанализировано ${n.successCount} файлов`),w.value=3,n}catch(c){const n=c.data?.message||c.message||"Ошибка анализа файлов";throw h.value=n,p.error(n),d.value.forEach(u=>{u.uiStatus==="analyzing"&&(u.uiStatus="error")}),c}finally{y.value=!1}},f=(c,n)=>{const u=d.value.find(k=>k.file.fileId===c);u&&(u.selectedStudent=n,u.uiStatus="ready",m.value.readyFiles=d.value.filter(k=>k.uiStatus==="ready").length)},V=(c,n)=>{const u=d.value.find(k=>k.file.fileId===c);u?.analysisResult?.extractedData&&(u.analysisResult.extractedData={...u.analysisResult.extractedData,...n})},L=c=>{const n=d.value.find(u=>u.file.fileId===c);n&&(n.isExpanded=!n.isExpanded)},F=async()=>{const c=d.value.filter(n=>n.uiStatus==="ready"&&n.selectedStudent&&n.analysisResult?.extractedData);if(c.length===0){h.value="Нет готовых файлов для импорта",p.error("Выберите студентов для всех сертификатов");return}y.value=!0,h.value=null;try{const n={items:c.map(k=>({fileId:k.file.fileId,studentId:k.selectedStudent.id,extractedData:k.analysisResult.extractedData}))},u=await l("/api/ai-certificates/batch/confirm",{method:"POST",body:n});return u.results.forEach(k=>{const M=d.value.find(T=>T.file.fileId===k.fileId);M&&(k.success?M.uiStatus="confirmed":M.uiStatus="error")}),u.errorCount>0?p.warning(`Импортировано ${u.successCount} из ${c.length} сертификатов`):p.success(`Успешно импортировано ${u.successCount} сертификатов`),w.value=5,u}catch(n){const u=n.data?.message||n.message||"Ошибка подтверждения импорта";throw h.value=u,p.error(u),n}finally{y.value=!1}},R=async()=>{try{return await l("/api/ai-certificates/stats")}catch(c){throw console.error("Ошибка получения статистики:",c),c}},N=async(c={})=>{try{return await l("/api/ai-certificates/logs",{params:c})}catch(n){throw console.error("Ошибка получения логов:",n),n}},D=B(()=>m.value.totalFiles===0?0:Math.round(m.value.readyFiles/m.value.totalFiles*100)),$=B(()=>m.value.readyFiles>0);return{batchItems:d,batchCurrentStep:w,batchStats:m,batchProgress:D,canConfirmBatch:$,isProcessing:y,error:h,reset:x,resetBatch:r,uploadBatch:e,analyzeBatch:s,selectStudentForFile:f,updateBatchItemData:V,toggleItemExpanded:L,confirmBatchImport:F,getStats:R,getLogs:N}},lt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},dt={class:"bg-white dark:bg-boxdark p-6 rounded-xl shadow-sm border border-stroke dark:border-strokedark"},nt={class:"flex items-center"},it={class:"text-2xl font-bold text-black dark:text-white"},ct={class:"mt-4 flex items-center text-sm"},ut={class:"text-success font-medium flex items-center mr-2"},gt={class:"bg-white dark:bg-boxdark p-6 rounded-xl shadow-sm border border-stroke dark:border-strokedark"},xt={class:"flex items-center"},mt={class:"text-2xl font-bold text-black dark:text-white"},ft={class:"mt-4 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5"},pt={class:"bg-white dark:bg-boxdark p-6 rounded-xl shadow-sm border border-stroke dark:border-strokedark"},bt={class:"flex items-center"},yt={class:"text-2xl font-bold text-black dark:text-white"},ht={class:"mt-4 text-xs text-gray-500 dark:text-gray-400"},vt=Y({__name:"ImportStats",props:{stats:{}},setup(l){const p=l,d=B(()=>p.stats.successRate?Math.round(p.stats.successRate*100):0),w=B(()=>p.stats.averageConfidence?Math.round(p.stats.averageConfidence*100):0),m=B(()=>p.stats.totalCost?p.stats.totalCost.toFixed(2):"0.00"),y=B(()=>p.stats.averageCost?p.stats.averageCost.toFixed(3):"0.000");return(h,x)=>(a(),o("div",lt,[t("div",dt,[t("div",nt,[x[1]||(x[1]=t("div",{class:"bg-primary/10 dark:bg-primary/20 p-3 rounded-lg text-primary mr-4"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("div",null,[x[0]||(x[0]=t("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"}," Всего обработано ",-1)),t("h3",it,i(l.stats.totalProcessed||0),1)])]),t("div",ct,[t("span",ut,[x[2]||(x[2]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),j(" "+i(d.value)+"% ",1)]),x[3]||(x[3]=t("span",{class:"text-gray-400 dark:text-gray-500"},"успешно",-1))])]),t("div",gt,[t("div",xt,[x[5]||(x[5]=t("div",{class:"bg-success/10 dark:bg-success/20 p-3 rounded-lg text-success mr-4"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",null,[x[4]||(x[4]=t("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"}," Средняя уверенность AI ",-1)),t("h3",mt,i(w.value)+"% ",1)])]),t("div",ft,[t("div",{class:"bg-success h-1.5 rounded-full transition-all duration-300",style:q({width:`${w.value}%`})},null,4)])]),t("div",pt,[t("div",bt,[x[7]||(x[7]=t("div",{class:"bg-warning/10 dark:bg-warning/20 p-3 rounded-lg text-warning mr-4"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",null,[x[6]||(x[6]=t("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"}," Общие расходы ",-1)),t("h3",yt," $"+i(m.value),1)])]),t("div",ht," Средняя стоимость: $"+i(y.value)+" / шт. ",1)])]))}}),kt=Object.assign(vt,{__name:"DatabaseAiImportStats"}),wt={class:"bg-white dark:bg-boxdark shadow-sm rounded-lg border border-stroke dark:border-strokedark overflow-hidden"},$t={class:"flex items-center gap-3"},_t={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary/10 text-primary"},Ct={class:"flex items-center space-x-2"},St={key:0,class:"overflow-hidden"},Mt={class:"overflow-x-auto"},zt={class:"min-w-full divide-y divide-gray-200"},jt={class:"bg-white divide-y divide-gray-200"},Bt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},It={class:"px-6 py-4 whitespace-nowrap"},Ft=["title"],Rt={class:"text-xs text-gray-500"},Dt={class:"px-6 py-4 whitespace-nowrap text-sm"},At={key:0,class:"text-gray-900"},Pt={key:1,class:"text-gray-400 italic"},Vt={key:2,class:"text-xs text-gray-500 mt-0.5 flex items-center"},Lt={key:0,class:"text-green-600 bg-green-50 px-1.5 rounded"},Nt={key:1,class:"text-blue-600 bg-blue-50 px-1.5 rounded"},Ut={key:2,class:"text-purple-600 bg-purple-50 px-1.5 rounded"},Ht={key:3,class:"text-gray-400 bg-gray-50 px-1.5 rounded"},Et={key:4,class:"ml-1 text-gray-400"},Tt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ot={class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800"},qt={class:"text-xs text-gray-400 mt-1"},Gt={class:"px-6 py-4 whitespace-nowrap"},Jt=["title"],Kt={class:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-500 font-mono"},Wt={key:0},Yt={key:0,class:"bg-white dark:bg-boxdark px-4 py-3 border-t border-gray-200 dark:border-strokedark flex items-center justify-between sm:px-6"},Qt={class:"flex-1 flex justify-between sm:hidden"},Xt=["disabled"],Zt=["disabled"],te={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},ee={class:"text-sm text-gray-700 dark:text-gray-300"},se={class:"font-medium"},re={class:"font-medium"},ae={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},oe=["disabled"],le=["disabled"],de=Y({__name:"ProcessingLogs",props:{logs:{},currentPage:{},totalPages:{}},emits:["page-change","refresh"],setup(l,{emit:p}){const d=S(!1),w=()=>{d.value=!d.value},m=x=>new Date(x).toLocaleString("ru-RU"),y=x=>{if(x===0)return"0 Bytes";const r=1024,e=["Bytes","KB","MB"],s=Math.floor(Math.log(x)/Math.log(r));return parseFloat((x/Math.pow(r,s)).toFixed(2))+" "+e[s]},h=x=>{switch(x){case"success":return"Успешно";case"failed":return"Ошибка";case"partial":return"Частично";default:return x}};return(x,r)=>(a(),o("div",wt,[t("button",{onClick:w,class:"w-full px-6 py-4 flex justify-between items-center bg-gray-50 dark:bg-meta-4 hover:bg-gray-100 dark:hover:bg-gray-800/50 transition-colors"},[t("div",$t,[r[5]||(r[5]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"}," История импортов ",-1)),l.logs.length>0?(a(),o("span",_t,i(l.logs.length),1)):b("",!0)]),t("div",Ct,[t("button",{onClick:r[0]||(r[0]=K(e=>x.$emit("refresh"),["stop"])),class:"p-2 text-gray-500 dark:text-gray-400 hover:text-primary rounded-full hover:bg-white dark:hover:bg-boxdark transition-colors",title:"Обновить"},[...r[6]||(r[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])]),(a(),o("svg",{class:_(["h-5 w-5 text-gray-400 dark:text-gray-500 transition-transform duration-200",{"rotate-180":d.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[7]||(r[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])]),I(Q,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"max-h-0 opacity-0","enter-to-class":"max-h-[2000px] opacity-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"max-h-[2000px] opacity-100","leave-to-class":"max-h-0 opacity-0"},{default:O(()=>[d.value?(a(),o("div",St,[t("div",Mt,[t("table",zt,[r[9]||(r[9]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Дата "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Файл "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Студент "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," AI Модель "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Статус "),t("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Стоимость ")])],-1)),t("tbody",jt,[(a(!0),o(A,null,P(l.logs,e=>(a(),o("tr",{key:e.id,class:"hover:bg-gray-50 transition-colors"},[t("td",Bt,i(m(e.processingStartedAt)),1),t("td",It,[t("div",{class:"text-sm font-medium text-gray-900 truncate max-w-xs",title:e.originalFilename},i(e.originalFilename),9,Ft),t("div",Rt,i(y(e.fileSizeBytes)),1)]),t("td",Dt,[e.extractedData?(a(),o("div",At,i(e.extractedData.fullName),1)):(a(),o("div",Pt,"Нет данных")),e.matchMethod?(a(),o("div",Vt,[e.matchMethod==="exact_pinfl"?(a(),o("span",Lt,"ПИНФЛ")):e.matchMethod==="exact_name"?(a(),o("span",Nt,"ФИО")):e.matchMethod==="fuzzy_ai"?(a(),o("span",Ut,"AI")):(a(),o("span",Ht,"Ручной")),e.matchConfidence?(a(),o("span",Et," ("+i(Math.round(e.matchConfidence*100))+"%) ",1)):b("",!0)])):b("",!0)]),t("td",Tt,[t("span",Ot,i(e.aiModel),1),t("div",qt,i(e.aiTokensUsed)+" токенов ",1)]),t("td",Gt,[t("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800":e.status==="success","bg-red-100 text-red-800":e.status==="failed","bg-yellow-100 text-yellow-800":e.status==="partial"}])},i(h(e.status)),3),e.errorMessage?(a(),o("div",{key:0,class:"text-xs text-red-500 mt-1 max-w-xs truncate",title:e.errorMessage},i(e.errorMessage),9,Jt)):b("",!0)]),t("td",Kt," $"+i(e.aiCostUsd?.toFixed(4)||"0.00"),1)]))),128)),l.logs.length===0?(a(),o("tr",Wt,[...r[8]||(r[8]=[t("td",{colspan:"6",class:"px-6 py-8 text-center text-gray-500 text-sm"}," Истории обработок пока нет ",-1)])])):b("",!0)])])]),l.totalPages>1?(a(),o("div",Yt,[t("div",Qt,[t("button",{onClick:r[1]||(r[1]=e=>x.$emit("page-change",l.currentPage-1)),disabled:l.currentPage<=1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-boxdark hover:bg-gray-50 dark:hover:bg-gray-800"}," Previous ",8,Xt),t("button",{onClick:r[2]||(r[2]=e=>x.$emit("page-change",l.currentPage+1)),disabled:l.currentPage>=l.totalPages,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-boxdark hover:bg-gray-50 dark:hover:bg-gray-800"}," Next ",8,Zt)]),t("div",te,[t("div",null,[t("p",ee,[r[10]||(r[10]=j(" Страница ",-1)),t("span",se,i(l.currentPage),1),r[11]||(r[11]=j(" из ",-1)),t("span",re,i(l.totalPages),1)])]),t("div",null,[t("nav",ae,[t("button",{onClick:r[3]||(r[3]=e=>x.$emit("page-change",l.currentPage-1)),disabled:l.currentPage<=1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-boxdark text-sm font-medium text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"},[...r[12]||(r[12]=[t("span",{class:"sr-only"},"Previous",-1),t("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L8.414 10l4.293 4.293a1 1 0 01-1.414 1.414l-5-5a1 1 0 010-1.414l5-5a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)])],8,oe),t("button",{onClick:r[4]||(r[4]=e=>x.$emit("page-change",l.currentPage+1)),disabled:l.currentPage>=l.totalPages,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-boxdark text-sm font-medium text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"},[...r[13]||(r[13]=[t("span",{class:"sr-only"},"Next",-1),t("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L11.586 10 7.293 5.707a1 1 0 011.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)])],8,le)])])])])):b("",!0)])):b("",!0)]),_:1})]))}}),ne=Object.assign(E(de,[["__scopeId","data-v-434e52c5"]]),{__name:"DatabaseAiImportProcessingLogs"}),ie={class:"space-y-6"},ce={class:"p-8 lg:p-12 text-center"},ue={class:"flex justify-center mb-4"},ge={class:"text-lg font-semibold text-black dark:text-white mb-2"},xe={key:0,class:"absolute inset-0 bg-white/80 dark:bg-boxdark/80 backdrop-blur-sm rounded-xl flex items-center justify-center"},me={key:0,class:"space-y-4"},fe={class:"flex items-center justify-between"},pe={class:"text-sm font-semibold text-black dark:text-white"},be=["disabled"],ye={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},he={class:"aspect-square bg-gray-100 dark:bg-gray-800 relative"},ve=["src","alt"],ke={key:1,class:"w-full h-full flex items-center justify-center text-gray-400"},we=["onClick","disabled"],$e={class:"absolute bottom-2 left-2 px-2 py-0.5 rounded bg-black/60 backdrop-blur-sm"},_e={class:"text-xs font-medium text-white"},Ce={key:2,class:"absolute inset-0 bg-red-500/90 backdrop-blur-sm flex items-center justify-center p-2"},Se={class:"text-xs text-white text-center font-medium"},Me={class:"p-2"},ze=["title"],je={class:"flex justify-end"},Be=["disabled"],Ie={key:0,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Fe={key:1,class:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"},Re={__name:"CertificatesBatchFileUploader",props:{loading:{type:Boolean,default:!1},maxFiles:{type:Number,default:20},maxFileSize:{type:Number,default:10*1024*1024}},emits:["upload"],setup(l,{emit:p}){const d=l,w=p,m=S(null),y=S(!1),h=S([]),x=["image/jpeg","image/jpg","image/png","application/pdf"],r=B(()=>h.value.filter($=>!$.error).length),e=B(()=>r.value>0),s=()=>{d.loading||m.value?.click()},f=$=>{const c=Array.from($.target.files||[]);L(c),$.target.value=""},V=$=>{if(y.value=!1,d.loading)return;const c=Array.from($.dataTransfer.files||[]);L(c)},L=$=>{if(h.value.length+$.length>d.maxFiles){X().error(`Максимум ${d.maxFiles} файлов за раз`);return}$.forEach(n=>{const u={file:n,preview:null,error:null};if(!x.includes(n.type))u.error="Неподдерживаемый формат";else if(n.size>d.maxFileSize)u.error=`Файл больше ${D(d.maxFileSize)}`;else if(n.type.startsWith("image/")){const k=new FileReader;k.onload=M=>{u.preview=M.target.result},k.readAsDataURL(n)}h.value.push(u)})},F=$=>{d.loading||h.value.splice($,1)},R=()=>{d.loading||(h.value=[])},N=()=>{const $=h.value.filter(c=>!c.error).map(c=>c.file);$.length>0&&w("upload",$)},D=$=>{if($===0)return"0 B";const c=1024,n=["B","KB","MB","GB"],u=Math.floor(Math.log($)/Math.log(c));return Math.round($/Math.pow(c,u)*100)/100+" "+n[u]};return($,c)=>(a(),o("div",ie,[t("div",{onDrop:K(V,["prevent"]),onDragover:c[0]||(c[0]=K(n=>y.value=!0,["prevent"])),onDragleave:c[1]||(c[1]=K(n=>y.value=!1,["prevent"])),class:_(["relative border-2 border-dashed rounded-xl transition-all duration-300",y.value?"border-primary bg-primary/5 dark:bg-primary/10 scale-[1.02]":"border-gray-300 dark:border-gray-600 hover:border-primary/50 dark:hover:border-primary/50",l.loading?"opacity-50 cursor-not-allowed":"cursor-pointer"]),onClick:s},[t("div",ce,[t("div",ue,[t("div",{class:_(["h-16 w-16 rounded-full flex items-center justify-center transition-all duration-300",y.value?"bg-primary text-white scale-110":"bg-gray-100 dark:bg-gray-800 text-gray-400"])},[...c[2]||(c[2]=[t("svg",{class:"h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)])],2)]),t("h3",ge,i(y.value?"Отпустите файлы здесь":"Загрузите сертификаты"),1),c[3]||(c[3]=W('<p class="text-sm text-gray-600 dark:text-gray-400 mb-4" data-v-ee52c66c> Перетащите файлы или нажмите для выбора </p><div class="flex flex-wrap items-center justify-center gap-2" data-v-ee52c66c><span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400" data-v-ee52c66c><svg class="h-3.5 w-3.5" fill="currentColor" viewBox="0 0 20 20" data-v-ee52c66c><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" data-v-ee52c66c></path></svg> Максимум 20 файлов </span><span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400" data-v-ee52c66c><svg class="h-3.5 w-3.5" fill="currentColor" viewBox="0 0 20 20" data-v-ee52c66c><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd" data-v-ee52c66c></path></svg> JPG, PNG, PDF </span><span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400" data-v-ee52c66c><svg class="h-3.5 w-3.5" fill="currentColor" viewBox="0 0 20 20" data-v-ee52c66c><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" data-v-ee52c66c></path></svg> До 10 МБ каждый </span></div>',2)),t("input",{ref_key:"fileInput",ref:m,type:"file",multiple:"",accept:"image/jpeg,image/jpg,image/png,application/pdf",onChange:f,class:"hidden"},null,544)]),l.loading?(a(),o("div",xe,[...c[4]||(c[4]=[t("div",{class:"text-center"},[t("div",{class:"h-12 w-12 mx-auto mb-3 animate-spin rounded-full border-4 border-primary border-t-transparent"}),t("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Загрузка файлов... ")],-1)])])):b("",!0)],34),h.value.length>0?(a(),o("div",me,[t("div",fe,[t("h4",pe," Выбрано файлов: "+i(h.value.length),1),t("button",{onClick:R,disabled:l.loading,class:"text-sm text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Очистить всё ",8,be)]),t("div",ye,[(a(!0),o(A,null,P(h.value,(n,u)=>(a(),o("div",{key:u,class:"group relative bg-white dark:bg-boxdark rounded-lg border border-stroke dark:border-strokedark overflow-hidden hover:shadow-lg transition-all duration-300"},[t("div",he,[n.preview?(a(),o("img",{key:0,src:n.preview,alt:n.file.name,class:"w-full h-full object-cover"},null,8,ve)):(a(),o("div",ke,[...c[5]||(c[5]=[t("svg",{class:"h-12 w-12",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z","clip-rule":"evenodd"})],-1)])])),t("button",{onClick:k=>F(u),disabled:l.loading,class:"absolute top-2 right-2 h-7 w-7 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 hover:bg-red-600 transition-all duration-200 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed"},[...c[6]||(c[6]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,we),t("div",$e,[t("span",_e,i(D(n.file.size)),1)]),n.error?(a(),o("div",Ce,[t("p",Se,i(n.error),1)])):b("",!0)]),t("div",Me,[t("p",{class:"text-xs font-medium text-gray-700 dark:text-gray-300 truncate",title:n.file.name},i(n.file.name),9,ze)])]))),128))]),t("div",je,[t("button",{onClick:N,disabled:l.loading||!e.value,class:"inline-flex items-center gap-2 px-6 py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed transition-all"},[l.loading?(a(),o("div",Fe)):(a(),o("svg",Ie,[...c[7]||(c[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1)])])),j(" "+i(l.loading?"Загрузка...":`Загрузить (${r.value})`),1)],8,Be)])])):b("",!0)]))}},De=E(Re,[["__scopeId","data-v-ee52c66c"]]),Ae={class:"space-y-4"},Pe={class:"flex items-center justify-between"},Ve={key:0,class:"text-xs text-success font-medium"},Le={key:0,class:"space-y-2"},Ne=["onClick"],Ue={class:"p-4"},He={class:"flex items-start gap-4"},Ee={class:"shrink-0 pt-1"},Te={key:0,class:"h-2 w-2 rounded-full bg-white"},Oe={class:"flex-1 min-w-0"},qe={class:"flex items-start justify-between gap-4"},Ge={class:"flex-1 min-w-0"},Je={class:"flex items-center gap-2 mb-2"},Ke={class:"text-sm font-semibold text-black dark:text-white truncate"},We={class:"space-y-1"},Ye={key:0,class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400"},Qe={class:"truncate"},Xe={key:1,class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400"},Ze={class:"truncate font-medium"},ts={key:2,class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400"},es={class:"truncate"},ss={key:3,class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400"},rs={class:"truncate"},as={class:"shrink-0 text-right"},os={class:"mt-3"},ls={class:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},ds={key:0,class:"absolute top-0 right-0 bg-primary text-white px-3 py-1 rounded-bl-lg text-xs font-semibold"},ns={key:1,class:"rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 p-6 text-center"},is={class:"flex flex-col items-center"},cs={key:2,class:"pt-2 border-t border-stroke dark:border-strokedark"},us={__name:"CertificatesStudentMatchAccordion",props:{fileId:{type:String,required:!0},matchResult:{type:Object,default:null},selectedStudent:{type:Object,default:null}},emits:["select","create-new"],setup(l,{emit:p}){const d=l,w=p,m=r=>d.selectedStudent?.id===r,y=r=>{w("select",r)},h=r=>r>=90?"text-success":r>=70?"text-primary":r>=50?"text-warning":"text-danger",x=r=>r>=90?"bg-success":r>=70?"bg-primary":r>=50?"bg-warning":"bg-danger";return(r,e)=>(a(),o("div",Ae,[t("div",Pe,[e[2]||(e[2]=t("h5",{class:"text-sm font-semibold text-black dark:text-white"}," Выбор слушателя ",-1)),l.selectedStudent?(a(),o("span",Ve," ✓ Выбран ")):b("",!0)]),l.matchResult?.topAlternatives&&l.matchResult.topAlternatives.length>0?(a(),o("div",Le,[(a(!0),o(A,null,P(l.matchResult.topAlternatives,(s,f)=>(a(),o("div",{key:s.student.id,onClick:V=>y(s.student),class:_(["relative rounded-lg border-2 transition-all duration-200 cursor-pointer overflow-hidden",m(s.student.id)?"border-primary bg-primary/5 dark:bg-primary/10 shadow-md":"border-stroke dark:border-strokedark hover:border-primary/50 dark:hover:border-primary/50 hover:shadow-sm"])},[t("div",Ue,[t("div",He,[t("div",Ee,[t("div",{class:_(["h-5 w-5 rounded-full border-2 flex items-center justify-center transition-all",m(s.student.id)?"border-primary bg-primary":"border-gray-300 dark:border-gray-600"])},[m(s.student.id)?(a(),o("div",Te)):b("",!0)],2)]),t("div",Oe,[t("div",qe,[t("div",Ge,[t("div",Je,[t("span",{class:_(["inline-flex items-center justify-center h-6 w-6 rounded-full text-xs font-bold",f===0?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":f===1?"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300":"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"])},i(f+1),3),t("h6",Ke,i(s.student.fullName),1)]),t("div",We,[s.student.pinfl?(a(),o("div",Ye,[e[3]||(e[3]=t("svg",{class:"h-3.5 w-3.5 shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule":"evenodd"})],-1)),t("span",Qe,"ПИНФЛ: "+i(s.student.pinfl),1)])):b("",!0),s.student.organization?(a(),o("div",Xe,[e[4]||(e[4]=t("svg",{class:"h-3.5 w-3.5 shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z","clip-rule":"evenodd"})],-1)),t("span",Ze,i(s.student.organization),1)])):b("",!0),s.student.department?(a(),o("div",ts,[e[5]||(e[5]=t("svg",{class:"h-3.5 w-3.5 shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z","clip-rule":"evenodd"}),t("path",{d:"M2 13.692V16a2 2 0 002 2h12a2 2 0 002-2v-2.308A24.974 24.974 0 0110 15c-2.796 0-5.487-.46-8-1.308z"})],-1)),t("span",es,i(s.student.department),1)])):b("",!0),s.student.email?(a(),o("div",ss,[e[6]||(e[6]=t("svg",{class:"h-3.5 w-3.5 shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),t("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})],-1)),t("span",rs,i(s.student.email),1)])):b("",!0)])]),t("div",as,[t("div",{class:_(["text-2xl font-bold",h(s.matchScore)])},i(s.matchScore)+"% ",3),e[7]||(e[7]=t("div",{class:"text-xs text-gray-500 dark:text-gray-400"}," совпадение ",-1))])]),t("div",os,[t("div",ls,[t("div",{class:_(["h-full transition-all duration-500 ease-out rounded-full",x(s.matchScore)]),style:q({width:`${s.matchScore}%`})},null,6)])])])])]),m(s.student.id)?(a(),o("div",ds," Выбран ")):b("",!0)],10,Ne))),128))])):l.matchResult&&(!l.matchResult.topAlternatives||l.matchResult.topAlternatives.length===0)?(a(),o("div",ns,[t("div",is,[e[9]||(e[9]=W('<div class="h-12 w-12 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-3" data-v-f03a98b4><svg class="h-6 w-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-f03a98b4><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" data-v-f03a98b4></path></svg></div><h6 class="text-sm font-semibold text-black dark:text-white mb-1" data-v-f03a98b4> Совпадений не найдено </h6><p class="text-xs text-gray-600 dark:text-gray-400 mb-4" data-v-f03a98b4> В базе данных нет подходящих слушателей </p>',3)),t("button",{onClick:e[0]||(e[0]=s=>r.$emit("create-new")),class:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors"},[...e[8]||(e[8]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),j(" Создать нового слушателя ",-1)])])])])):b("",!0),l.matchResult?.topAlternatives&&l.matchResult.topAlternatives.length>0?(a(),o("div",cs,[t("button",{onClick:e[1]||(e[1]=s=>r.$emit("create-new")),class:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-primary dark:hover:border-primary hover:bg-primary/5 dark:hover:bg-primary/10 transition-all text-sm font-medium text-gray-700 dark:text-gray-300"},[...e[10]||(e[10]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),j(" Создать нового слушателя ",-1)])])])):b("",!0)]))}},gs=E(us,[["__scopeId","data-v-f03a98b4"]]),xs={class:"space-y-4"},ms={class:"bg-gradient-to-r from-primary/10 to-success/10 dark:from-primary/20 dark:to-success/20 rounded-xl p-6 border border-primary/20 dark:border-primary/30"},fs={class:"flex items-center justify-between mb-4"},ps={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},bs={class:"text-right"},ys={class:"text-2xl font-bold text-primary"},hs={class:"relative h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},vs={class:"grid grid-cols-3 gap-4 mt-4"},ks={class:"text-center"},ws={class:"text-xl font-bold text-success"},$s={class:"text-center"},_s={class:"text-xl font-bold text-danger"},Cs={class:"text-center"},Ss={class:"text-xl font-bold text-warning"},Ms={class:"space-y-3"},zs=["onClick"],js={class:"h-16 w-16 rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 flex-shrink-0"},Bs=["src","alt"],Is={key:1,class:"w-full h-full flex items-center justify-center text-gray-400"},Fs={class:"flex-1 text-left min-w-0"},Rs={class:"text-sm font-semibold text-black dark:text-white truncate"},Ds={class:"flex items-center gap-2 mt-1"},As={key:0,class:"text-xs text-gray-600 dark:text-gray-400 truncate"},Ps={class:"flex-shrink-0"},Vs={key:0,class:"border-t border-stroke dark:border-strokedark"},Ls={class:"p-6 space-y-6"},Ns={key:0,class:"rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 p-4"},Us={class:"flex items-start gap-3"},Hs={class:"flex-1"},Es={class:"text-sm text-red-700 dark:text-red-300 mt-1"},Ts={key:1,class:"space-y-4"},Os={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},qs={class:"space-y-1.5"},Gs=["onUpdate:modelValue","onInput"],Js={key:0,class:"text-xs text-red-500"},Ks={class:"space-y-1.5"},Ws=["onUpdate:modelValue","onInput"],Ys={class:"space-y-1.5"},Qs=["onUpdate:modelValue","onInput"],Xs={class:"space-y-1.5"},Zs=["onUpdate:modelValue","onInput"],tr={class:"space-y-1.5"},er=["onUpdate:modelValue","onInput"],sr={class:"space-y-1.5"},rr=["onUpdate:modelValue","onInput"],ar={key:2},or={__name:"CertificatesBatchAnalysisResults",props:{items:{type:Array,required:!0},stats:{type:Object,required:!0}},emits:["toggle-item","select-student","update-field"],setup(l,{emit:p}){const d=p,w=r=>{d("toggle-item",r)},m=(r,e,s)=>{d("update-field",{fileId:r,field:e,value:s})},y=r=>{const e={uploaded:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300",analyzing:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",analyzed:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",ready:"bg-success/10 text-success dark:bg-success/20",error:"bg-danger/10 text-danger dark:bg-danger/20",confirmed:"bg-success/10 text-success dark:bg-success/20"};return e[r]||e.uploaded},h=r=>{const e={uploaded:"bg-gray-500",analyzing:"bg-blue-500 animate-pulse",analyzed:"bg-purple-500",ready:"bg-success",error:"bg-danger",confirmed:"bg-success"};return e[r]||e.uploaded},x=r=>({uploaded:"Загружен",analyzing:"Анализ...",analyzed:"Проанализирован",ready:"Готов",error:"Ошибка",confirmed:"Подтверждён"})[r]||"Неизвестно";return(r,e)=>(a(),o("div",xs,[t("div",ms,[t("div",fs,[t("div",null,[e[0]||(e[0]=t("h3",{class:"text-lg font-semibold text-black dark:text-white"}," Результаты анализа ",-1)),t("p",ps,i(l.stats.analyzedFiles)+" из "+i(l.stats.totalFiles)+" обработано ",1)]),t("div",bs,[t("div",ys,i(Math.round(l.stats.analyzedFiles/l.stats.totalFiles*100))+"% ",1),e[1]||(e[1]=t("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"прогресс",-1))])]),t("div",hs,[t("div",{class:"absolute inset-y-0 left-0 bg-gradient-to-r from-primary to-success transition-all duration-500 ease-out",style:q({width:`${l.stats.analyzedFiles/l.stats.totalFiles*100}%`})},null,4)]),t("div",vs,[t("div",ks,[e[2]||(e[2]=t("div",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"}," Готово ",-1)),t("div",ws,i(l.stats.readyFiles),1)]),t("div",$s,[e[3]||(e[3]=t("div",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"}," Ошибки ",-1)),t("div",_s,i(l.stats.errorFiles),1)]),t("div",Cs,[e[4]||(e[4]=t("div",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"}," Стоимость ",-1)),t("div",Ss," $"+i(l.stats.totalCost),1)])])]),t("div",Ms,[(a(!0),o(A,null,P(l.items,s=>(a(),o("div",{key:s.file.fileId,class:"bg-white dark:bg-boxdark rounded-xl border border-stroke dark:border-strokedark overflow-hidden transition-all duration-300 hover:shadow-lg"},[t("button",{onClick:f=>w(s.file.fileId),class:"w-full px-6 py-4 flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors"},[t("div",js,[s.file.previewUrl?(a(),o("img",{key:0,src:s.file.previewUrl,alt:s.file.originalName,class:"w-full h-full object-cover"},null,8,Bs)):(a(),o("div",Is,[...e[5]||(e[5]=[t("svg",{class:"h-8 w-8",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z","clip-rule":"evenodd"})],-1)])]))]),t("div",Fs,[t("h4",Rs,i(s.file.originalName),1),t("div",Ds,[t("span",{class:_(["inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium",y(s.uiStatus)])},[t("span",{class:_(["h-1.5 w-1.5 rounded-full",h(s.uiStatus)])},null,2),j(" "+i(x(s.uiStatus)),1)],2),s.selectedStudent?(a(),o("span",As," → "+i(s.selectedStudent.fullName),1)):b("",!0)])]),t("div",Ps,[(a(),o("svg",{class:_(["h-5 w-5 text-gray-400 transition-transform duration-200",{"rotate-180":s.isExpanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])],8,zs),I(Q,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"max-h-0 opacity-0","enter-to-class":"max-h-[2000px] opacity-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"max-h-[2000px] opacity-100","leave-to-class":"max-h-0 opacity-0"},{default:O(()=>[s.isExpanded?(a(),o("div",Vs,[t("div",Ls,[s.uiStatus==="error"&&s.analysisResult?.error?(a(),o("div",Ns,[t("div",Us,[e[8]||(e[8]=t("svg",{class:"h-5 w-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("div",Hs,[e[7]||(e[7]=t("h5",{class:"text-sm font-semibold text-red-900 dark:text-red-200"}," Ошибка обработки ",-1)),t("p",Es,i(s.analysisResult.error),1)])])])):b("",!0),s.analysisResult?.extractedData?(a(),o("div",Ts,[e[15]||(e[15]=t("div",{class:"flex items-center justify-between mb-2"},[t("h5",{class:"text-sm font-semibold text-black dark:text-white"}," Извлечённые данные "),t("span",{class:"text-xs text-gray-500 dark:text-gray-400"}," Все поля редактируемы ")],-1)),t("div",Os,[t("div",qs,[e[9]||(e[9]=t("label",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"},[j(" ФИО "),t("span",{class:"text-red-500"},"*")],-1)),U(t("input",{"onUpdate:modelValue":f=>s.analysisResult.extractedData.fullName=f,onInput:f=>m(s.file.fileId,"fullName",f.target.value),type:"text",required:"",class:_(["w-full px-3 py-2 border rounded-lg text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50 bg-white dark:bg-boxdark text-black dark:text-white border-gray-300 dark:border-gray-600",{"border-red-500 dark:border-red-500":!s.analysisResult.extractedData.fullName}]),placeholder:"Введите ФИО"},null,42,Gs),[[H,s.analysisResult.extractedData.fullName]]),s.analysisResult.extractedData.fullName?b("",!0):(a(),o("span",Js," Обязательное поле "))]),t("div",Ks,[e[10]||(e[10]=t("label",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"}," Номер сертификата ",-1)),U(t("input",{"onUpdate:modelValue":f=>s.analysisResult.extractedData.certificateNumber=f,onInput:f=>m(s.file.fileId,"certificateNumber",f.target.value),type:"text",class:"w-full px-3 py-2 border rounded-lg text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50 bg-white dark:bg-boxdark text-black dark:text-white border-gray-300 dark:border-gray-600",placeholder:"Введите номер сертификата"},null,40,Ws),[[H,s.analysisResult.extractedData.certificateNumber]])]),t("div",Ys,[e[11]||(e[11]=t("label",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"}," Дата выдачи ",-1)),U(t("input",{"onUpdate:modelValue":f=>s.analysisResult.extractedData.issueDate=f,onInput:f=>m(s.file.fileId,"issueDate",f.target.value),type:"date",class:"w-full px-3 py-2 border rounded-lg text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50 bg-white dark:bg-boxdark text-black dark:text-white border-gray-300 dark:border-gray-600"},null,40,Qs),[[H,s.analysisResult.extractedData.issueDate]])]),t("div",Xs,[e[12]||(e[12]=t("label",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"}," Название курса ",-1)),U(t("input",{"onUpdate:modelValue":f=>s.analysisResult.extractedData.courseName=f,onInput:f=>m(s.file.fileId,"courseName",f.target.value),type:"text",class:"w-full px-3 py-2 border rounded-lg text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50 bg-white dark:bg-boxdark text-black dark:text-white border-gray-300 dark:border-gray-600",placeholder:"Введите название курса"},null,40,Zs),[[H,s.analysisResult.extractedData.courseName]])]),t("div",tr,[e[13]||(e[13]=t("label",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"}," Организация ",-1)),U(t("input",{"onUpdate:modelValue":f=>s.analysisResult.extractedData.organization=f,onInput:f=>m(s.file.fileId,"organization",f.target.value),type:"text",class:"w-full px-3 py-2 border rounded-lg text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50 bg-white dark:bg-boxdark text-black dark:text-white border-gray-300 dark:border-gray-600",placeholder:"Введите организацию"},null,40,er),[[H,s.analysisResult.extractedData.organization]])]),t("div",sr,[e[14]||(e[14]=t("label",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"}," Длительность ",-1)),U(t("input",{"onUpdate:modelValue":f=>s.analysisResult.extractedData.duration=f,onInput:f=>m(s.file.fileId,"duration",f.target.value),type:"text",class:"w-full px-3 py-2 border rounded-lg text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50 bg-white dark:bg-boxdark text-black dark:text-white border-gray-300 dark:border-gray-600",placeholder:"Например: 72 часа"},null,40,rr),[[H,s.analysisResult.extractedData.duration]])])])])):b("",!0),s.analysisResult?.matchResult?(a(),o("div",ar,[I(gs,{"file-id":s.file.fileId,"match-result":s.analysisResult.matchResult,"selected-student":s.selectedStudent,onSelect:f=>r.$emit("select-student",s.file.fileId,f)},null,8,["file-id","match-result","selected-student","onSelect"])])):b("",!0)])])):b("",!0)]),_:2},1024)]))),128))])]))}},lr=E(or,[["__scopeId","data-v-bec04105"]]),dr={class:"space-y-6"},nr={class:"bg-gradient-to-br from-primary/10 via-success/10 to-info/10 dark:from-primary/20 dark:via-success/20 dark:to-info/20 rounded-xl p-6 border-2 border-primary/30 dark:border-primary/40"},ir={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},cr={class:"bg-white/60 dark:bg-boxdark/60 backdrop-blur-sm rounded-lg p-4 text-center"},ur={class:"text-3xl font-bold text-black dark:text-white mb-1"},gr={class:"bg-white/60 dark:bg-boxdark/60 backdrop-blur-sm rounded-lg p-4 text-center"},xr={class:"text-3xl font-bold text-success mb-1"},mr={class:"bg-white/60 dark:bg-boxdark/60 backdrop-blur-sm rounded-lg p-4 text-center"},fr={class:"text-3xl font-bold text-warning mb-1"},pr={class:"bg-white/60 dark:bg-boxdark/60 backdrop-blur-sm rounded-lg p-4 text-center"},br={class:"text-3xl font-bold text-primary mb-1"},yr={key:0,class:"bg-white dark:bg-boxdark rounded-xl border border-stroke dark:border-strokedark overflow-hidden"},hr={class:"px-6 py-4 border-b border-stroke dark:border-strokedark"},vr={class:"text-sm font-semibold text-black dark:text-white"},kr={class:"divide-y divide-stroke dark:divide-strokedark max-h-96 overflow-y-auto"},wr={class:"flex items-center gap-4"},$r={class:"flex-1 min-w-0"},_r={class:"flex items-center gap-2 mb-1"},Cr={class:"text-sm font-semibold text-black dark:text-white truncate"},Sr={class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-primary/10 text-primary"},Mr={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400"},zr={class:"truncate"},jr={class:"flex-shrink-0 text-right"},Br={class:"text-lg font-bold text-success"},Ir={key:1,class:"bg-warning/10 dark:bg-warning/20 border-2 border-warning/30 dark:border-warning/40 rounded-xl p-6"},Fr={class:"flex items-start gap-4"},Rr={class:"flex-1"},Dr={class:"text-sm font-semibold text-warning mb-2"},Ar={class:"space-y-1 text-sm text-gray-700 dark:text-gray-300"},Pr={class:"truncate"},Vr={class:"text-xs text-gray-500 dark:text-gray-400"},Lr={key:0,class:"text-xs text-gray-500 dark:text-gray-400 italic"},Nr={class:"flex flex-col sm:flex-row gap-3"},Ur=["disabled"],Hr=["disabled"],Er={key:0,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Tr={key:1,class:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"},Or={key:2},qr={key:3},Gr={key:2,class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},Jr={__name:"CertificatesBatchConfirmPanel",props:{items:{type:Array,required:!0},stats:{type:Object,required:!0},loading:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(l,{emit:p}){const d=l,w=B(()=>d.items.filter(r=>r.uiStatus==="ready"&&r.selectedStudent&&r.analysisResult?.extractedData)),m=B(()=>d.items.filter(r=>r.uiStatus!=="ready"||!r.selectedStudent||!r.analysisResult?.extractedData)),y=B(()=>w.value.length>0&&!d.loading),h=r=>!r.selectedStudent||!r.analysisResult?.matchResult?.topAlternatives?0:r.analysisResult.matchResult.topAlternatives.find(s=>s.student.id===r.selectedStudent.id)?.matchScore||0,x=r=>r.uiStatus==="error"?"ошибка анализа":r.selectedStudent?r.analysisResult?.extractedData?"требует проверки":"нет данных":"не выбран студент";return(r,e)=>(a(),o("div",dr,[t("div",nr,[e[6]||(e[6]=W('<div class="flex items-start justify-between mb-6" data-v-6c9b392f><div data-v-6c9b392f><h3 class="text-xl font-bold text-black dark:text-white mb-2" data-v-6c9b392f> Подтверждение импорта </h3><p class="text-sm text-gray-600 dark:text-gray-400" data-v-6c9b392f> Проверьте сводку перед финальным сохранением </p></div><div class="h-14 w-14 rounded-full bg-primary/20 dark:bg-primary/30 flex items-center justify-center" data-v-6c9b392f><svg class="h-8 w-8 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-6c9b392f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" data-v-6c9b392f></path></svg></div></div>',1)),t("div",ir,[t("div",cr,[t("div",ur,i(l.stats.totalFiles),1),e[2]||(e[2]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400 font-medium"}," Всего файлов ",-1))]),t("div",gr,[t("div",xr,i(l.stats.readyFiles),1),e[3]||(e[3]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400 font-medium"}," Готовы к импорту ",-1))]),t("div",mr,[t("div",fr,i(l.stats.totalFiles-l.stats.readyFiles),1),e[4]||(e[4]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400 font-medium"}," Требуют внимания ",-1))]),t("div",pr,[t("div",br," $"+i(l.stats.totalCost),1),e[5]||(e[5]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400 font-medium"}," Стоимость AI ",-1))])])]),w.value.length>0?(a(),o("div",yr,[t("div",hr,[t("h4",vr," Сертификаты к импорту ("+i(w.value.length)+") ",1)]),t("div",kr,[(a(!0),o(A,null,P(w.value,s=>(a(),o("div",{key:s.file.fileId,class:"px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors"},[t("div",wr,[e[9]||(e[9]=t("div",{class:"h-10 w-10 rounded-full bg-success/10 dark:bg-success/20 flex items-center justify-center flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-success",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t("div",$r,[t("div",_r,[t("h5",Cr,i(s.analysisResult?.extractedData?.fullName||"Без имени"),1),t("span",Sr,i(s.analysisResult?.extractedData?.certificateNumber||"Без номера"),1)]),t("div",Mr,[e[7]||(e[7]=t("svg",{class:"h-3.5 w-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule":"evenodd"})],-1)),t("span",zr,i(s.selectedStudent?.fullName),1)])]),t("div",jr,[t("div",Br,i(h(s))+"% ",1),e[8]||(e[8]=t("div",{class:"text-xs text-gray-500 dark:text-gray-400"}," совпадение ",-1))])])]))),128))])])):b("",!0),m.value.length>0?(a(),o("div",Ir,[t("div",Fr,[e[11]||(e[11]=t("div",{class:"h-10 w-10 rounded-full bg-warning/20 dark:bg-warning/30 flex items-center justify-center flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-warning",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),t("div",Rr,[t("h5",Dr," Требуют внимания ("+i(m.value.length)+") ",1),t("ul",Ar,[(a(!0),o(A,null,P(m.value.slice(0,3),s=>(a(),o("li",{key:s.file.fileId,class:"flex items-center gap-2"},[e[10]||(e[10]=t("span",{class:"h-1.5 w-1.5 rounded-full bg-warning"},null,-1)),t("span",Pr,i(s.file.originalName),1),t("span",Vr," ("+i(x(s))+") ",1)]))),128)),m.value.length>3?(a(),o("li",Lr," и ещё "+i(m.value.length-3)+"... ",1)):b("",!0)])])])])):b("",!0),t("div",Nr,[t("button",{onClick:e[0]||(e[0]=s=>r.$emit("cancel")),disabled:l.loading,class:"flex-1 inline-flex items-center justify-center gap-2 px-6 py-3.5 border-2 border-gray-300 dark:border-gray-600 rounded-lg text-sm font-semibold text-gray-700 dark:text-gray-300 bg-white dark:bg-boxdark hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-all"},[...e[12]||(e[12]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),j(" Отменить ",-1)])],8,Ur),t("button",{onClick:e[1]||(e[1]=s=>r.$emit("confirm")),disabled:!y.value||l.loading,class:"flex-1 sm:flex-[2] inline-flex items-center justify-center gap-2 px-6 py-3.5 bg-gradient-to-r from-success to-success-600 text-white rounded-lg text-sm font-semibold hover:from-success-600 hover:to-success-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-success disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-500 transition-all shadow-lg hover:shadow-xl"},[l.loading?(a(),o("div",Tr)):(a(),o("svg",Er,[...e[13]||(e[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),l.loading?(a(),o("span",Or,"Импорт...")):(a(),o("span",qr,"Импортировать "+i(w.value.length)+" сертификатов",1))],8,Hr)]),l.loading?(a(),o("div",Gr,[...e[14]||(e[14]=[W('<div class="flex items-center gap-3" data-v-6c9b392f><div class="h-8 w-8 animate-spin rounded-full border-3 border-primary border-t-transparent" data-v-6c9b392f></div><div class="flex-1" data-v-6c9b392f><p class="text-sm font-semibold text-black dark:text-white" data-v-6c9b392f> Импорт в процессе... </p><p class="text-xs text-gray-600 dark:text-gray-400 mt-0.5" data-v-6c9b392f> Пожалуйста, не закрывайте страницу </p></div></div>',1)])])):b("",!0)]))}},Kr=E(Jr,[["__scopeId","data-v-6c9b392f"]]),Wr={class:"flex flex-col gap-6"},Yr={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Qr={class:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 mb-2"},Xr={class:"bg-white dark:bg-boxdark rounded-xl shadow-sm border border-stroke dark:border-strokedark p-6"},Zr={class:"flex items-center justify-between mb-4"},ta={class:"text-xs text-gray-500 dark:text-gray-400"},ea={class:"relative"},sa={class:"absolute top-5 left-0 right-0 h-0.5 bg-gray-200 dark:bg-gray-700"},ra={class:"relative flex justify-between"},aa={key:0,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},oa={key:1,class:"text-sm font-semibold"},la={class:"mt-2 text-center w-full"},da={class:"bg-white dark:bg-boxdark rounded-xl shadow-md border border-stroke dark:border-strokedark overflow-hidden"},na={class:"p-6 lg:p-8"},ia={key:0,class:"space-y-6"},ca={key:1,class:"space-y-6"},ua={class:"flex items-center gap-3 mb-6"},ga={key:0,class:"text-center py-12"},xa={key:1,class:"text-center py-8"},ma={key:2,class:"space-y-6"},fa={key:3,class:"space-y-6"},pa={key:4,class:"py-12 text-center"},ba={class:"mt-8 flex justify-center gap-4"},ya={class:"flex flex-col sm:flex-row justify-between items-center gap-3 px-6 lg:px-8 py-4 bg-gray-50 dark:bg-meta-4 border-t border-stroke dark:border-strokedark"},ha=["disabled"],va={key:1},ka=["disabled"],wa=Y({__name:"ai-import-certificates",setup(l){const{batchItems:p,batchCurrentStep:d,batchStats:w,canConfirmBatch:m,isProcessing:y,resetBatch:h,uploadBatch:x,analyzeBatch:r,selectStudentForFile:e,toggleItemExpanded:s,confirmBatchImport:f,getStats:V,getLogs:L}=ot(),F=[{number:1,name:"Загрузка"},{number:2,name:"Анализ"},{number:3,name:"Выбор"},{number:4,name:"Подтверждение"},{number:5,name:"Финиш"}],R=S(null),N=S([]),D=S(1),$=S(1),c=async z=>{try{await x(z),await r()}catch(g){console.error(g)}},n=()=>{d.value<5&&d.value++},u=()=>{d.value>1&&d.value--},k=async()=>{try{await f(),T(),G()}catch(z){console.error(z)}},M=({fileId:z,field:g,value:J})=>{const C=p.value.find(tt=>tt.file.fileId===z);C?.analysisResult?.extractedData&&(C.analysisResult.extractedData[g]=J)},T=async()=>{try{R.value=await V()}catch(z){console.error(z)}},G=async(z=1)=>{try{const g=await L({page:z,limit:5});N.value=g.logs,D.value=g.page,$.value=g.totalPages}catch(g){console.error(g)}},Z=z=>{G(z)};return st(()=>{T(),G()}),(z,g)=>{const J=et;return a(),o("div",Wr,[t("div",Yr,[t("div",null,[t("div",Qr,[I(J,{to:"/database/import-certificates",class:"hover:text-primary transition-colors"},{default:O(()=>[...g[3]||(g[3]=[j(" База сертификатов ",-1)])]),_:1}),g[4]||(g[4]=t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)),g[5]||(g[5]=t("span",{class:"text-black dark:text-white font-medium"},"AI Импорт",-1))]),g[6]||(g[6]=t("h1",{class:"text-2xl font-semibold text-black dark:text-white"}," Пакетный AI Импорт Сертификатов ",-1)),g[7]||(g[7]=t("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Массовое распознавание и импорт сертификатов с помощью искусственного интеллекта ",-1))])]),R.value?(a(),rt(kt,{key:0,stats:R.value},null,8,["stats"])):b("",!0),t("div",Xr,[t("div",Zr,[g[8]||(g[8]=t("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Прогресс импорта ",-1)),t("span",ta," Шаг "+i(v(d))+" из "+i(F.length),1)]),t("div",ea,[t("div",sa,[t("div",{class:"h-full bg-linear-to-r from-primary to-success transition-all duration-500",style:q({width:`${(v(d)-1)/(F.length-1)*100}%`})},null,4)]),t("div",ra,[(a(),o(A,null,P(F,C=>t("div",{key:C.number,class:"flex flex-col items-center z-10",style:q({width:`${100/F.length}%`})},[t("div",{class:_(["relative flex h-10 w-10 items-center justify-center rounded-full border-2 transition-all duration-300 bg-white dark:bg-boxdark",[v(d)===C.number?"border-primary text-primary shadow-lg shadow-primary/30 scale-110":v(d)>C.number?"border-success bg-success text-white":"border-gray-300 dark:border-gray-600 text-gray-400"]])},[v(d)>C.number?(a(),o("svg",aa,[...g[9]||(g[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)])])):(a(),o("span",oa,i(C.number),1))],2),t("div",la,[t("p",{class:_(["text-xs font-medium transition-colors truncate px-1",[v(d)>=C.number?"text-black dark:text-white":"text-gray-500 dark:text-gray-400"]])},i(C.name),3)])],4)),64))])])]),t("div",da,[t("div",na,[I(Q,{name:"fade",mode:"out-in"},{default:O(()=>[(a(),o("div",{key:"batch-"+v(d)},[v(d)===1?(a(),o("div",ia,[g[10]||(g[10]=t("div",{class:"flex items-center gap-3 mb-6"},[t("div",{class:"h-12 w-12 rounded-lg bg-primary/10 dark:bg-primary/20 flex items-center justify-center shrink-0"},[t("svg",{class:"h-6 w-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})])]),t("div",null,[t("h2",{class:"text-lg font-semibold text-black dark:text-white"}," Пакетная загрузка "),t("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Загрузите до 20 файлов сертификатов (PDF, JPG, PNG) ")])],-1)),I(De,{loading:v(y),onUpload:c},null,8,["loading"])])):v(d)===2?(a(),o("div",ca,[t("div",ua,[t("div",{class:_(["h-12 w-12 rounded-lg bg-primary/10 dark:bg-primary/20 flex items-center justify-center shrink-0",{"animate-pulse":v(y)}])},[...g[11]||(g[11]=[t("svg",{class:"h-6 w-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})],-1)])],2),g[12]||(g[12]=t("div",null,[t("h2",{class:"text-lg font-semibold text-black dark:text-white"}," Анализ файлов "),t("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Идёт пакетная обработка и распознавание сертификатов ")],-1))]),v(y)?(a(),o("div",ga,[...g[13]||(g[13]=[t("div",{class:"h-16 w-16 mx-auto mb-4 animate-spin rounded-full border-4 border-primary border-t-transparent"},null,-1),t("h3",{class:"text-lg font-medium text-black dark:text-white"}," Обработка... ",-1),t("p",{class:"text-gray-500"}," Пожалуйста, подождите, это может занять некоторое время. ",-1)])])):(a(),o("div",xa,[t("button",{onClick:g[0]||(g[0]=(...C)=>v(r)&&v(r)(...C)),class:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/90"}," Запустить анализ ")]))])):v(d)===3?(a(),o("div",ma,[g[14]||(g[14]=t("div",{class:"flex items-center gap-3 mb-6"},[t("div",{class:"h-12 w-12 rounded-lg bg-info/10 dark:bg-info/20 flex items-center justify-center shrink-0"},[t("svg",{class:"h-6 w-6 text-info",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])]),t("div",null,[t("h2",{class:"text-lg font-semibold text-black dark:text-white"}," Проверка и выбор "),t("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Проверьте результаты и выберите слушателей для каждого файла ")])],-1)),I(lr,{items:v(p),stats:v(w),onToggleItem:v(s),onSelectStudent:v(e),onUpdateField:M},null,8,["items","stats","onToggleItem","onSelectStudent"])])):v(d)===4?(a(),o("div",fa,[g[15]||(g[15]=t("div",{class:"flex items-center gap-3 mb-6"},[t("div",{class:"h-12 w-12 rounded-lg bg-success/10 dark:bg-success/20 flex items-center justify-center shrink-0"},[t("svg",{class:"h-6 w-6 text-success",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])]),t("div",null,[t("h2",{class:"text-lg font-semibold text-black dark:text-white"}," Пакетное подтверждение "),t("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Финальная проверка перед сохранением в базу ")])],-1)),I(Kr,{items:v(p),stats:v(w),loading:v(y),onConfirm:k,onCancel:g[1]||(g[1]=C=>d.value=3)},null,8,["items","stats","loading"])])):v(d)===5?(a(),o("div",pa,[g[17]||(g[17]=t("div",{class:"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-success/10"},[t("svg",{class:"h-10 w-10 text-success",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),g[18]||(g[18]=t("h3",{class:"mt-4 text-2xl font-bold text-gray-900 dark:text-white"}," Импорт завершен! ",-1)),g[19]||(g[19]=t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Все готовые сертификаты были успешно добавлены в базу данных. ",-1)),t("div",ba,[t("button",{onClick:g[2]||(g[2]=C=>{v(h)(),T()}),class:"rounded-lg bg-primary px-6 py-3 text-sm font-medium text-white hover:bg-primary/90 shadow-lg hover:shadow-xl transition-all"}," Загрузить ещё "),I(J,{to:"/database?tab=certificates",class:"rounded-lg border border-gray-300 bg-white px-6 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"},{default:O(()=>[...g[16]||(g[16]=[j(" Перейти в базу ",-1)])]),_:1})])])):b("",!0)]))]),_:1})]),t("div",ya,[v(d)>1&&v(d)<5?(a(),o("button",{key:0,onClick:u,class:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-lg text-gray-700 dark:text-gray-300 bg-white dark:bg-boxdark hover:bg-gray-50 dark:hover:bg-gray-800 disabled:opacity-50",disabled:v(y)}," ← Назад ",8,ha)):(a(),o("div",va)),v(d)===3?(a(),o("button",{key:2,onClick:n,class:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-5 py-2.5 bg-primary text-white rounded-lg hover:bg-primary-600 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:!v(m)},[...g[20]||(g[20]=[j(" Далее к подтверждению ",-1),t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,ka)):b("",!0)])]),I(ne,{logs:N.value,"current-page":D.value,"total-pages":$.value,onPageChange:Z,onRefresh:G},null,8,["logs","current-page","total-pages"])])}}}),Ba=E(wa,[["__scopeId","data-v-3fe34149"]]);export{Ba as default};
